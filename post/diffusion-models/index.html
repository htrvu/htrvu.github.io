<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Tr√¨nh b√†y n·ªÅn t·∫£ng to√°n v√† qu√° tr√¨nh training, sampling c·ªßa c√°c m√¥ h√¨nh diffusion models'>
<title>L√Ω thuy·∫øt v·ªÅ diffusion models</title>

<link rel='canonical' href='https://htrvu.github.io/post/diffusion-models/'>

<link rel="stylesheet" href="/scss/style.min.5eda91a11f055cbfcec5ec0fd36a1f7cba21a6a47d4778547d7d8f3099d2ebe2.css"><meta property='og:title' content='L√Ω thuy·∫øt v·ªÅ diffusion models'>
<meta property='og:description' content='Tr√¨nh b√†y n·ªÅn t·∫£ng to√°n v√† qu√° tr√¨nh training, sampling c·ªßa c√°c m√¥ h√¨nh diffusion models'>
<meta property='og:url' content='https://htrvu.github.io/post/diffusion-models/'>
<meta property='og:site_name' content='Trong-Vu Hoang'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='diffusion' /><meta property='article:tag' content='generative' /><meta property='article:tag' content='vae' /><meta property='article:tag' content='unet' /><meta property='article:published_time' content='2023-04-11T22:52:57&#43;07:00'/><meta property='article:modified_time' content='2023-04-11T22:52:57&#43;07:00'/>
<meta name="twitter:title" content="L√Ω thuy·∫øt v·ªÅ diffusion models">
<meta name="twitter:description" content="Tr√¨nh b√†y n·ªÅn t·∫£ng to√°n v√† qu√° tr√¨nh training, sampling c·ªßa c√°c m√¥ h√¨nh diffusion models">
    <link rel="shortcut icon" href="/neural.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu4ef57fa6d8ae56d86d9663ef18f7ace5_124758_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Trong-Vu Hoang</a></h1>
            <h2 class="site-description">On my way!</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/htrvu'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/htrvu/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"/> <rect x="4" y="4" width="16" height="16" rx="2" /> <line x1="8" y1="11" x2="8" y2="16" /> <line x1="8" y1="8" x2="8" y2="8.01" /> <line x1="12" y1="16" x2="12" y2="11" /> <path d="M16 16v-3a2 2 0 0 0 -4 0" /> </svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#gi·ªõi-thi·ªáu-v·ªÅ-diffusion-models">Gi·ªõi thi·ªáu v·ªÅ diffusion models</a></li>
    <li><a href="#forward-diffusion">Forward diffusion</a></li>
    <li><a href="#reverse-diffusion">Reverse diffusion</a>
      <ol>
        <li><a href="#ƒë·∫∑t-v·∫•n-ƒë·ªÅ">ƒê·∫∑t v·∫•n ƒë·ªÅ</a></li>
        <li><a href="#x√°c-ƒë·ªãnh-loss-function">X√°c ƒë·ªãnh loss function</a></li>
        <li><a href="#tham-s·ªë-h√≥a-l_t">Tham s·ªë h√≥a $L_t$</a></li>
      </ol>
    </li>
    <li><a href="#variance-scheduler">Variance scheduler</a></li>
    <li><a href="#qu√°-tr√¨nh-training-v√†-sampling">Qu√° tr√¨nh training v√† sampling</a></li>
    <li><a href="#nh·∫≠n-x√©t">Nh·∫≠n x√©t</a></li>
    <li><a href="#t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/dl/" style="background-color: #2a9d8f; color: #fff;">
                Deep Learning
            </a>
        
            <a href="/categories/cv/" style="background-color: #2a9d8f; color: #fff;">
                Computer Vision
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/diffusion-models/">L√Ω thuy·∫øt v·ªÅ diffusion models</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Tr√¨nh b√†y n·ªÅn t·∫£ng to√°n v√† qu√° tr√¨nh training, sampling c·ªßa c√°c m√¥ h√¨nh diffusion models
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 11, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    16 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p><strong>Note.</strong> V√¨ m√¨nh c≈©ng ƒëang trong qu√° tr√¨nh t√¨m hi·ªÉu v·ªÅ diffusion models n√™n t·∫°m th·ªùi blog s·∫Ω ng·ª´ng c√°c b√†i vi·∫øt trong ch·ªß ƒë·ªÅ NLP l·∫°i m·ªôt th·ªùi gian ƒë·ªÉ t·∫≠p trung cho diffusion models nh√© üòÄ</p>
<h2 id="gi·ªõi-thi·ªáu-v·ªÅ-diffusion-models">Gi·ªõi thi·ªáu v·ªÅ diffusion models</h2>
<p>Trong th·ªùi gian g·∫ßn ƒë√¢y, xu h∆∞·ªõng ‚ÄúAI v·∫Ω tranh&quot; ƒëang r·∫•t l√† hot v√† c√°c m√¥ h√¨nh sinh ·∫£nh n·ªïi ti·∫øng ƒë√≥ h·∫ßu h·∫øt l√† d·ª±a tr√™n <strong>diffusion models</strong>, ƒë·∫∑c bi·ªát l√† Stable Diffusion.</p>
<div>
<div style="display: flex; justify-content: space-around; align-items: center;">
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/stable_diffusion_ex1.png'>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px" src='./images/stable_diffusion_ex2.png'>
</div>
</div>
<p align="center">Minh h·ªça ·∫£nh sinh b·ªüi Stable Diffusion<br>Ngu·ªìn: <a href='https://stablediffusionweb.com/'>Stable Diffusion Online</a>
</div>
<p>B√†i to√°n Image Generation, hay Image Synthesis, kh√¥ng ph·∫£i l√† b√†i to√°n m·ªõi m√† ta ƒë√£ c√≥ kh√° nhi·ªÅu h·ªç m√¥ h√¨nh ƒë∆∞·ª£c nghi√™n c·ª©u v√† c√¥ng b·ªë. C∆° b·∫£n nh·∫•t l√† Autoencoder, Variational Autoencoder (VAE), Normalizing Flow v√† n·ªïi ti·∫øng nh·∫•t l√† Generative Adversarial Network. Trong image generation th√¨ ta c√≥ m·ªôt c√°i g·ªçi l√† <strong>generative trilemma</strong>. √ù nghƒ©a c·ªßa c√°i n√†y l√† c√°c m√¥ h√¨nh sinh ·∫£nh s·∫Ω ch·ªâ ƒë·∫°t ƒë∆∞·ª£c nhi·ªÅu nh·∫•t l√† 2 trong 3 ti√™u ch√≠ sau: Th·ªùi gian sinh ·∫£nh nhanh, ch·∫•t l∆∞·ª£ng ·∫£nh r√µ n√©t v√† n·ªôi dung ·∫£nh ƒëa d·∫°ng.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/trilemma.png'>
<p align="center" style="margin: 0; color: #888;">The generative trilemma<br>
Ngu·ªìn: <a href='https://www.youtube.com/watch?v=B5gfJF8mOPo'>Tanishq Abraham</a>
</p>
</div>
<ul>
<li>GAN th√¨ sinh ·∫£nh nhanh v√† ch·∫•t l∆∞·ª£ng ·∫£nh r√µ n√©t nh∆∞ng c√°c ·∫£nh n√≥ sinh ra th∆∞·ªùng tr√¥ng kh√° gi·ªëng nhau, t·ª©c l√† thi·∫øu s·ª± ƒëa d·∫°ng</li>
<li>VAE v√† Normalizing Flow th√¨ ƒë·∫°t ƒë∆∞·ª£c m·∫∑t t·ªëc ƒë·ªô v√† ƒëa d·∫°ng nh∆∞ng ch·∫•t l∆∞·ª£ng ·∫£nh th√¨ kh√¥ng t·ªët l·∫Øm.</li>
</ul>
<p>V·ªõi diffusion models, ta th∆∞·ªùng ƒë·∫°t ƒë∆∞·ª£c ti√™u ch√≠ ch·∫•t l∆∞·ª£ng v√† s·ª± ƒëa d·∫°ng nh∆∞ng t·ªëc ƒë·ªô th√¨ l·∫°i kh√° ch·∫≠m. Do ƒë√≥, h·∫ßu h·∫øt c√°c c·∫£i ti·∫øn trong difusion models l√† li√™n quan ƒë·∫øn vi·ªác tƒÉng t·ªëc qu√° tr√¨nh sinh ·∫£nh.</p>
<p>√ù t∆∞·ªüng chung c·ªßa diffusion models l√† ta <strong>t·ª´ng b∆∞·ªõc th√™m nhi·ªÖu</strong> v√†o ·∫£nh ban ƒë·∫ßu ƒë·ªÉ ‚Äúph√° h·ªßy‚Äù ph√¢n ph·ªëi c·ªßa d·ªØ li·ªáu, sau ƒë√≥ <strong>h·ªçc c√°ch kh√¥i ph·ª•c l·∫°i</strong> c·∫•u tr√∫c c·ªßa ·∫£nh g·ªëc. Sau ƒë√≥, ƒë·ªÉ sinh ·∫£nh th√¨ ta xu·∫•t ph√°t t·ª´ m·ªôt ·∫£nh nhi·ªÖu ho√†n to√†n v√† t·ª´ t·ª´ kh·ª≠ nhi·ªÖu ƒë·ªÉ c√≥ ƒë∆∞·ª£c ·∫£nh k·∫øt qu·∫£.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/diffusion_general.png'>
<p align="center" style="margin: 0; color: #888;">√ù t∆∞·ªüng chung c·ªßa diffusion models
</div>
<p>M√¥ h√¨nh <strong>Diffusion Probability Model</strong> ƒë∆∞·ª£c gi·ªõi thi·ªáu ƒë·∫ßu ti√™n trong paper nƒÉm 2015 l√† <strong>Deep Unsupervised Learning using Nonequilibrium Thermodynamics</strong>. Ph·∫ßn to√°n c·ªßa m√¥ h√¨nh n√†y r·∫•t l√† n·∫∑ng v√† n√≥ √≠t ƒë∆∞·ª£c c·ªông ƒë·ªìng ƒë·ªÉ √Ω t·ªõi khi m√† k·∫øt qu·∫£ l√∫c ƒë∆∞·ª£c c√¥ng b·ªë th√¨ c≈©ng kh√¥ng c√≥ g√¨ n·ªïi b·∫≠t. M√£i ƒë·∫øn nƒÉm 2020, <strong>Denoising Diffusion Probability Model (DDPM)</strong> ƒë∆∞·ª£c c√¥ng b·ªë v√† c√≥ th·ªÉ n√≥i ƒë√¢y l√† s·ª± ki·ªán quan tr·ªçng khi nh·ªù paper n√†y m√† diffusion models m·ªõi tr·ªü th√†nh m·ªôt ch·ªß ƒë·ªÅ nghi√™n c·ª©u ƒë∆∞·ª£c nhi·ªÅu ng∆∞·ªùi quan t√¢m.</p>
<p>N√≥i ƒë·∫øn c√°c m√¥ h√¨nh ·∫£o di·ªáu nh∆∞ Stable Diffusion th√¨ ta c√≤n c√≥ nhi·ªÅu chi ti·∫øt kh√°c n·ªØa nh∆∞ng n√≥ s·∫Ω kh√¥ng n·∫±m trong ph·∫°m vi b√†i vi·∫øt n√†y. M√¨nh s·∫Ω t·∫≠p trung v√†o ph·∫ßn l√Ω thuy·∫øt to√°n c·ªßa m√¥ h√¨nh ƒë·ªÉ l√†m n·ªÅn t·∫£ng cho c√°c b√†i vi·∫øt sau.</p>
<h2 id="forward-diffusion">Forward diffusion</h2>
<p>Gi·∫£ s·ª≠ data sample (‚Äú·∫£nh‚Äù ban ƒë·∫ßu) ƒë∆∞·ª£c l·∫•y m·∫´u t·ª´ ph√¢n ph·ªëi d·ªØ li·ªáu th·∫≠t s·ª± $\bold{x}_0 \sim q(\bold{x})$. Feed forward l√† qu√° tr√¨nh ta th√™m m·ªôt l∆∞·ª£ng nh·ªè <strong>Gaussian noise</strong> v√†o data sample $\bold{x}_0$ th√¥ng qua $T$ b∆∞·ªõc, t·ª´ ƒë√≥ c√≥ c√°c noisy samples $\bold{x}_1, \bold{x}_2,&hellip;, \bold{x}_T$. Ph√¢n b·ªë c·ªßa data sample $\bold{x}_t$ ch·ªâ ph·ª• thu·ªôc v√†o $\bold{x}_{t-1}$ nh∆∞ sau:</p>
<p>$$
\begin{equation}
q(\bold{x}_t | \bold{x}_{t-1}) = \mathcal{N}\left(\bold{x}_{t-1}; \sqrt{1-\beta_t} \bold{x}_{t-1}, \beta_t \bold{I} \right)
\end{equation}
$$</p>
<p>C√¥ng th·ª©c $(1)$ c√≥ nghƒ©a l√† ‚Äú·∫£nh‚Äù t·∫°i b∆∞·ªõc th·ª© $t$ ƒë∆∞·ª£c sample t·ª´ m·ªôt <strong>conditional Gaussian distribution</strong> v·ªõi mean $\mu_t = \sqrt{1 - \beta_t} \bold{x}_{t-1}$ v√† variance $\sigma^2 = \beta_t$. V·ªõi gi·∫£ thi·∫øt s·ª± ph·ª• thu·ªôc, ta c≈©ng c√≥ th·ªÉ xem ƒë√¢y l√† m·ªôt x√≠ch Markov.</p>
<ul>
<li><strong>L∆∞u √Ω.</strong> $q$ l√† <strong>probability density fuction</strong> (h√†m m·∫≠t ƒë·ªô x√°c su·∫•t) c·ªßa ph√¢n ph·ªëi chu·∫©n.</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 150px;" src='./images/forward.png'>
<p align="center" style="margin: 0; color: #888;">Minh h·ªça qu√° tr√¨nh forward<br>
Ngu·ªìn: <a href='https://medium.com/@steinsfu/diffusion-model-clearly-explained-cd331bd41166'>Steins</a>
</p>
</div>
<p>B·∫±ng <strong>re-parameterization trick</strong>, ta c√≥ th·ªÉ sample $\bold{x}_t$ nh∆∞ sau:</p>
<p>$$
\begin{equation}
\bold{x}_t = \sqrt{1 - \beta_t} \bold{x}_{t-1} + \epsilon_{t-1} \sqrt {\beta_t}
\end{equation}
$$</p>
<p>v·ªõi $\epsilon_{t-1} \sim \mathcal{N}(\bold{0}, \bold{I})$.</p>
<p>C√°c gi√° tr·ªã ph∆∞∆°ng sai $\beta_t$ l√† <strong>ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr∆∞·ªõc</strong> v√† n√≥ ƒë∆∞·ª£c g·ªçi l√† <strong>variance scheduler.</strong> Ta s·∫Ω ƒë·ªÅ c·∫≠p kƒ© h∆°n v·ªÅ scheduler ·ªü <a class="link" href="#variance-scheduler" ><strong>ph·∫ßn 4</strong></a>. Tr∆∞·ªõc h·∫øt th√¨ c√≥ m·ªôt s·ªë nh·∫≠n x√©t nh∆∞ sau:</p>
<ul>
<li>$0 &lt; \beta_1 &lt; \beta_2 &lt; &hellip; &lt; \beta_T &lt; 1$</li>
<li>C√≥ th·ªÉ hi·ªÉu r·∫±ng c√†ng ƒë·∫øn c√°c b∆∞·ªõc sau th√¨ ta th√™m c√†ng nhi·ªÅu nhi·ªÖu v√†o data sample (v√¨ variance ng√†y c√†ng l·ªõn). Khi $t \to \infty$, ph√¢n b·ªë c·ªßa $\bold{x}_T$ s·∫Ω t∆∞∆°ng ƒë∆∞∆°ng v·ªõi <strong>isotropic Gaussian distribution,</strong> t·ª©c l√† $\bold{x}_T \sim \mathcal{N}(\bold{0}, \bold{I})$.</li>
</ul>
<p>Quay tr·ªü l·∫°i v·ªõi c√¥ng th·ª©c x√°c ƒë·ªãnh ph√¢n ph·ªëi c·ªßa $\bold{x}_t$. ƒê·ªÉ x√°c ƒë·ªãnh ph√¢n ph·ªëi c·ªßa $\bold{x}_T$ th√¨ ta s·∫Ω t√≠nh d·∫ßn t·ª´ng b∆∞·ªõc nh∆∞ sau:</p>
<p>$$
\begin{equation}
q(\bold{x}_{1:T} \vert \mathbf{x}_0) = \prod^T_{t=1} q(\bold{x}_t \vert \bold{x}_{t-1})
\end{equation}
$$</p>
<p>T√≠nh nh∆∞ tr√™n th√¨ tr√¥ng c√≥ v·∫ª l√† kh√° l√¢u!</p>
<p>M·ªôt <strong>t√≠nh ch·∫•t th√∫ v·ªã</strong> c·ªßa qu√° tr√¨nh forward l√† ta c√≥ th·ªÉ sample ƒë∆∞·ª£c ngay $\bold{x}_t$ v·ªõi b·∫•t k√¨ timestep $t$ n√†o.  ƒê·∫∑t $\alpha_t = 1 - \beta_t$ v√† $\bar{\alpha}_t = \prod_{i=1}^t \alpha_i$. V√¨ $\beta_t$ ƒë·ªÅu ƒë∆∞·ª£c x√°c ƒë·ªãnh s·∫µn n√™n ta c≈©ng s·∫Ω t√≠nh tr∆∞·ªõc ƒë∆∞·ª£c $\bar{\alpha_t}$. T·ª´ c√¥ng th·ª©c $(2)$ ta c√≥</p>
<p>$$
\begin{aligned}
\mathbf{x}_t
&amp;= \sqrt{\alpha_t}\mathbf{x}_{t-1} + \sqrt{1 - \alpha_t}\boldsymbol{\epsilon}_{t-1} \\
&amp;= \sqrt{\alpha_t \alpha_{t-1}} \bold{x}_{t-2} + \sqrt{\alpha_t - \alpha_t \alpha_{t-1}} \epsilon_{t-2} + \sqrt{1 - \alpha_t} \epsilon_{t-1}
\end{aligned}
$$</p>
<p>Khi ta g·ªôp hai Gaussion distribution $\mathcal{N}(\bold{0}, \sigma_1^2 \bold{I})$ v√† $\mathcal{N}(\bold{0}, \sigma_2^2 \bold{I})$ (√Ω n√≥i ƒë·∫øn hai ƒë·∫°i l∆∞·ª£ng ch·ª©a $\epsilon_{t-2}$ v√† $\epsilon_{t-1}$ ·ªü tr√™n) th√¨ ph√¢n ph·ªëi thu ƒë∆∞·ª£c s·∫Ω l√† $\mathcal{N}(\bold{0}, (\sigma_1^2 + \sigma_2^2) \bold{I})$. Do ƒë√≥, t·ª´ c√¥ng th·ª©c tr√™n ta c√≥ th·ªÉ vi·∫øt l·∫°i th√†nh</p>
<p>$$
\mathbf{x}_t
= \sqrt{\alpha_t \alpha_{t-1}} \bold{x}_{t-2} + \sqrt{1 - \alpha_t \alpha_{t-1}} \bar{\epsilon}_{t-2}
$$</p>
<p>C·ª© ti·∫øp t·ª•c bi·∫øn ƒë·ªïi th√¨ ta s·∫Ω c√≥</p>
<p>$$
\mathbf{x}_t
= \sqrt{\bar{\alpha_t}} \bold{x}_{0} + \sqrt{1 - \bar{\alpha_t}} \epsilon
$$</p>
<p>v·ªõi $\epsilon \sim \mathcal{N}(\bold{0}, \bold{I})$.</p>
<p>T√≥m l·∫°i, trong qu√° tr√¨nh forward, ta c√≥ th·ªÉ sample $\bold{x}_t$ d·ª±a v√†o ph√¢n ph·ªëi sau:</p>
<p>$$
q(\mathbf{x}_t \vert \mathbf{x}_0) = \mathcal{N}(\mathbf{x}_t; \sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1 - \bar{\alpha}_t)\mathbf{I})
$$</p>
<h2 id="reverse-diffusion">Reverse diffusion</h2>
<h3 id="ƒë·∫∑t-v·∫•n-ƒë·ªÅ">ƒê·∫∑t v·∫•n ƒë·ªÅ</h3>
<p>Qu√° tr√¨nh forward diffusion d·∫ßn d·∫ßn th√™m c√°c Gaussian noise v√†o sample d·ª±a theo c√°c ph√¢n ph·ªëi $q(\bold{x}_t|\bold{x}_{t-1})$. N·∫øu ta c√≥ th·ªÉ ƒëi ng∆∞·ª£c l·∫°i, t·ª©c l√† xu·∫•t ph√°t t·ª´ m·ªôt sample $\bold{x}_{T} \sim q(\bold{x}_T) = \mathcal{N}(\bold{0}, \bold{I})$ v√† d·∫ßn sample $\bold{x}_{t-1}$ theo ph√¢n ph·ªëi $q(\bold{x}_{t-1} | \bold{x}_t)$ n√†o ƒë√≥ th√¨ khi th·ª±c hi·ªán cho ƒë·∫øn $\bold{x}_0$, ta ƒë√£ c√≥ th·ªÉ <strong>denoise</strong> (kh·ª≠ nhi·ªÖu) ƒë·ªÉ thu l·∫°i ƒë∆∞·ª£c sample <strong>x·∫•p x·ªâ</strong> sample ban ƒë·∫ßu c·ªßa qu√° tr√¨nh forward.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 300px;" src='./images/forward_and_reverse.png'>
<p align="center" style="margin: 0; color: #888;">Minh h·ªça qu√° tr√¨nh forward v√† reverse</p>
</div>
<p>Tuy nhi√™n, vi·ªác x√°c ƒë·ªãnh $q(\bold{x}_{t-1} | \bold{x}_t)$ l√† r·∫•t kh√≥ v√¨ n√≥ li√™n quan ƒë·∫øn ph√¢n ph·ªëi c·ªßa to√†n b·ªô d·ªØ li·ªáu. Do ƒë√≥, ta s·∫Ω t√¨m c√°ch <strong>x·∫•p x·ªâ</strong> ph√¢n ph·ªëi n√†y.</p>
<ul>
<li>Kƒ© h∆°n v·ªÅ l√Ω do kh√≥ x√°c ƒë·ªãnh $q(\bold{x}_{t-1} | \bold{x}_t)$: V√¨ c√≥ r·∫•t nhi·ªÅu kh·∫£ nƒÉng c√≥ th·ªÉ x·∫£y ra ƒë·ªëi v·ªõi $\bold{x}_{t-1}$ n√™n ph∆∞∆°ng sai c·ªßa ph√¢n ph·ªëi n√†y c≈©ng s·∫Ω r·∫•t l·ªõn.</li>
<li>Gi·∫£ s·ª≠ ta c·∫ßn x√°c ƒë·ªãnh $q(\bold{x}_{t-1} | \bold{x}_t, \bold{x}_0)$ th√¨ m·ªçi chuy·ªán s·∫Ω d·ªÖ d√†ng h∆°n. Khi bi·∫øt tr∆∞·ªõc th√™m $\bold{x}_0$ n·ªØa th√¨ ta c√≥ th·ªÉ h√¨nh dung ƒë∆∞·ª£c $\bold{x}_{t-1}$ <strong>n√™n tr√¥ng nh∆∞ th·∫ø n√†o.</strong> Kƒ© thu·∫≠t n√†y g·ªçi l√† variance reduction step.</li>
<li>M·ªôt c√°ch tr·ª±c gi√°c, ta ƒëo√°n ƒë∆∞·ª£c nh·ªØng g√¨ c·∫ßn l√†m khi bi·∫øt th√™m $\bold{x}_0$ l√† th·ª±c hi·ªán <strong>n·ªôi suy $\bold{x}_{t-1}$ d·ª±a v√†o $\bold{x}_0$ v√† $\bold{x}_{t}$</strong>. Ta s·∫Ω quay l·∫°i v·ªõi nh·∫≠n x√©t n√†y sau.</li>
</ul>
<p>ƒê·ªÉ √Ω r·∫±ng v·ªõi $\bold{x}_T \sim \mathcal{N}(\bold{0}, \bold{I})$ v√† $\beta_T$ ƒë·ªß nh·ªè th√¨ $q(\bold{x}_{T-1}|\bold{x}_T)$ c≈©ng l√† m·ªôt Gaussian distribution. M·ªôt c√°ch ƒë·ªá quy, ta c√≥ th·ªÉ xem to√†n b·ªô $q(\bold{x}_{t-1} | \bold{x}_t)$ l√† Gaussian distribution lu√¥n üòÄ ƒê·ªÉ x·∫•p x·ªâ  $q(\bold{x}_{t-1} | \bold{x}_t)$, ta s·∫Ω s·ª≠ d·ª•ng m·ªôt <strong>m√¥ h√¨nh</strong> $p_{\theta}$ ƒë·ªÉ d·ª± ƒëo√°n gi√° tr·ªã mean $\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)$ v√† variance $\boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t)$. T·ª´ ƒë√≥ x·∫•p x·ªâ ƒë∆∞·ª£c</p>
<p>$$
p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t), \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t))
$$</p>
<ul>
<li>L∆∞u √Ω r·∫±ng c√°c gi√° tr·ªã ƒë·∫ßu v√†o c·ªßa m√¥ h√¨nh bao g·ªìm c·∫£ $\bold{x}_t$ v√† timestep $t$ (cho bi·∫øt m·ª©c ƒë·ªô noise ƒë∆∞·ª£c d√πng ƒë·ªÉ t·∫°o ra $\bold{x}_t$ trong qu√° tr√¨nh forward).</li>
<li>M√¥ h√¨nh $p_\theta$ th∆∞·ªùng l√† <strong>U-Net</strong>. T·∫°m th·ªùi ta s·∫Ω b·ªè qua chi ti·∫øt v·ªÅ ki·∫øn tr√∫c c·ªßa m√¥ h√¨nh n√†y.</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 150px;" src='./images/reverse_unet.png'>
<p align="center" style="margin: 0; color: #888;">Minh h·ªça m√¥ h√¨nh U-Net trong qu√° tr√¨nh reverse<br>
Ngu·ªìn: <a href='https://medium.com/@steinsfu/diffusion-model-clearly-explained-cd331bd41166'>Steins</a>
</p>
</div>
<ul>
<li>Trong qu√° tr√¨nh forward, ta ƒë√£ ƒë·ªÅ c·∫≠p l√† c√°c gi√° tr·ªã variance ƒë√£ ƒë∆∞·ª£c x√°c ƒë·ªãnh tr∆∞·ªõc d·ª±a v√†o scheluder n√™n ·ªü ƒë√¢y th√¨ ta <strong>kh√¥ng c·∫ßn d·ª± ƒëo√°n variance</strong>. Khi ƒë√≥</li>
</ul>
<p>$$
p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t), \beta_t \bold{I})
$$</p>
<p><strong>Gi·∫£ s·ª≠</strong> ta ƒë√£ h·ªçc ƒë∆∞·ª£c m√¥ h√¨nh $p_{\theta}$ nh∆∞ tr√™n th√¨ t·ª´ $\bold{x}_T$ ta c√≥ th·ªÉ x·∫•p x·ªâ ƒë∆∞·ª£c ph√¢n ph·ªëi c·ªßa $\bold{x}_0$ nh∆∞ sau:</p>
<p>$$
p_\theta (\bold{x}_{0:T}) = q (\bold{x}_T) \prod_{t=1}^T p_\theta (\bold{x}_{t-1} | \bold{x}_t)
$$</p>
<p>V·∫•n ƒë·ªÅ ƒë·∫∑t ra l√† ta hu·∫•n luy·ªán m√¥ h√¨nh $p_\theta$ nh∆∞ th·∫ø n√†o. V·∫≠y th√¨ ta c·∫ßn ph·∫£i t√¨m loss function!</p>
<h3 id="x√°c-ƒë·ªãnh-loss-function">X√°c ƒë·ªãnh loss function</h3>
<p>M·ª•c ti√™u c·ªßa ta l√† <strong>minimize the negative log likelihood</strong>  $-\log p_\theta (\bold{x}_0)$. Bi·∫øn ƒë·ªïi m·ªôt ch√∫t nh∆∞ sau:</p>
<p>$$
\begin{aligned}
-\log p_\theta(\mathbf{x}_0)
&amp;\leq - \log p_\theta(\mathbf{x}_0) + D_\text{KL}(q(\mathbf{x}_{1:T}\vert\mathbf{x}_0) \| \color{red}p_\theta(\mathbf{x}_{1:T}\vert\mathbf{x}_0) \color{default} ) \\
&amp;= -\log p_\theta(\mathbf{x}_0) + \mathbb{E}_{\mathbf{x}_{1:T}\sim q(\mathbf{x}_{1:T} \vert \mathbf{x}_0)} \Big[ \log\frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{\color{red}p_\theta(\mathbf{x}_{0:T}) / p_\theta(\mathbf{x}_0)} \Big] \\
&amp;= -\log p_\theta(\mathbf{x}_0) + \mathbb{E}_q \Big[ \log\frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{p_\theta(\mathbf{x}_{0:T})} + \log p_\theta(\mathbf{x}_0) \Big] \\
&amp;= \mathbb{E}_q \Big[ \log \frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{p_\theta(\mathbf{x}_{0:T})} \Big]
\end{aligned}
$$</p>
<p>ƒê·∫∑t $L_{VLB} = \mathbb{E}_q \Big[ \log \frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{p_\theta(\mathbf{x}_{0:T})} \Big]$ (variational lower bound). Nh·∫≠n x√©t r·∫±ng n·∫øu minimize ƒë∆∞·ª£c $L_{VLB}$ th√¨ gi√° tr·ªã c·ªßa negative log likelihood c≈©ng s·∫Ω nh·ªè üòÄ Do ƒë√≥, h√†m m·ª•c ti√™u c·ªßa ta s·∫Ω l√† $L_{VLB}$.</p>
<p>Ti·∫øp t·ª•c bi·∫øn ƒë·ªïi $L_{VLB}$, ta c√≥</p>
<p>$$
\begin{aligned}
L_\text{VLB}
&amp;= \mathbb{E}_{q(\mathbf{x}_{0:T})} \Big[ \log\frac{\color{red}q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{\color{blue}p_\theta(\mathbf{x}_{0:T})} \Big] \\
&amp;= \mathbb{E}_q \Big[ \log\frac{\color{red}\prod_{t=1}^T q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{\color{blue} p_\theta(\mathbf{x}_T) \prod_{t=1}^T p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t) } \Big] \\
&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=1}^T \log \frac{q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} \Big] \\
&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{\color{green}q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\
&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \Big( \frac{\color{green}q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)}\cdot \frac{\color{green}q(\mathbf{x}_t \vert \mathbf{x}_0)}{\color{green}q(\mathbf{x}_{t-1}\vert\mathbf{x}_0)} \Big) + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big]
\end{aligned}
$$</p>
<ul>
<li>
<p>Trong d√≤ng bi·∫øn ƒë·ªïi ·ªü tr√™n, √°p d·ª•ng c√¥ng th·ª©c Bayes th√¨ ta c√≥</p>
<p>$$
q(\bold{x}_t | \bold{x}_{t-1}) = \frac{q(\bold{x}_{t-1} | \bold{x}_t) \cdot q(\bold{x}_t)}{q(\bold{x}_{t-1})}
$$</p>
<p>Ta c√≥ nh·∫≠n x√©t ·∫£o ma r·∫±ng n·∫øu ta cho th√™m m·ªôt ƒëi·ªÅu ki·ªán l√† $\bold{x}_0$ th√¨ c√°c gi√° tr·ªã tr√™n s·∫Ω <strong>d·ªÖ t√≠nh h∆°n r·∫•t nhi·ªÅu</strong> (c√≥ th·ªÉ t·∫≠n d·ª•ng qu√° tr√¨nh forward). V·∫≠y th√¨ ‚Äúassume‚Äù lu√¥n l√†</p>
<p>$$
q(\bold{x}_t | \bold{x}_{t-1}) = \frac{q(\bold{x}_{t-1} | \bold{x}_t, \bold{x}_0) \cdot q(\bold{x}_t | \bold{x}_0)}{q(\bold{x}_{t-1} | \bold{x}_0)}
$$</p>
</li>
</ul>
<p>OK, ti·∫øp t·ª•c bi·∫øn ƒë·ªïi $L_{VLB}$:</p>
<p>$$
\begin{aligned}
L_\text{VLB}
&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \color{red}\sum_{t=2}^T \log \frac{q(\mathbf{x}_t \vert \mathbf{x}_0)}{q(\mathbf{x}_{t-1} \vert \mathbf{x}_0)} \color{default} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\
&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \color{red}\log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{q(\mathbf{x}_1 \vert \mathbf{x}_0)} \color{default} + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big]\\
&amp;= \mathbb{E}_q \Big[ \color{green}-\log p_\theta(\mathbf{x}_T) \color{default} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{\color{green}q(\mathbf{x}_T \vert \mathbf{x}_0)}{\color{blue}p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \\
&amp;= \mathbb{E}_q \Big[ \color{green}\log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_T)} \color{default} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} - \color{blue}\log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)\color{default} \Big]
\end{aligned}
$$</p>
<p>V√† b∆∞·ªõc cu·ªëi c√πng:</p>
<p>$$
\begin{aligned}L_{LVB}
&amp;= \mathbb{E}_q [\color{red}\underbrace{D_\text{KL}(q(\mathbf{x}_T \vert \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_T))}_{L_T} \color{default} + \color{blue}\sum_{t=2}^T \underbrace{D_\text{KL}(q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t))}_{L_{t-1}} \color{green} \underbrace{- \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)}_{L_0} ] \\
&amp;= L_T + \left (L_1 + L_2 + \cdots + L_{T-1}\right) + L_0
\end{aligned}
$$</p>
<ul>
<li>Nh√¨n chung th√¨ ƒë√¢y to√†n l√† loss li√™n quan ƒë·∫øn kho·∫£ng c√°ch c√°c ph√¢n ph·ªëi trong t·ª´ng timestep.</li>
</ul>
<p>V√¨ $\bold{x}_T \sim \mathcal{N}(\bold{0}, \bold{I})$ n√™n $L_T$ l√† m·ªôt h·∫±ng s·ªë (khi $T \to \infty$ th√¨ $L_T \to 0$) v√† ta c√≥ th·ªÉ b·ªè qua n√≥. Ngo√†i ra, v√¨ gi√° tr·ªã ph∆∞∆°ng sai $\beta_1$ l√† r·∫•t nh·ªè v√† th∆∞·ªùng th√¨ ‚Äú·∫£nh&quot; $\bold{x}_0$ v√† $\bold{x}_1$ tr√¥ng s·∫Ω r·∫•t gi·ªëng nhau (v√¨ l∆∞·ª£ng nhi·ªÖu th√™m v√†o l√† r·∫•t √≠t). V√¨ l√Ω do n√†y m√† c√°c t√°c gi·∫£ c·ªßa DDPM th·∫≠t s·ª± ƒë√£ b·ªè qua n√≥ trong qu√° tr√¨nh hu·∫•n luy·ªán.</p>
<p>Nh∆∞ v·∫≠y ta c√≤n l·∫°i m·ªói $L_t$ v·ªõi $1 \leq t \leq T - 1$. ƒê·ªëi v·ªõi c√°i n√†y th√¨ c·∫ßn c√≥ m·ªôt s·ªë <strong>ma thu·∫≠t</strong>.</p>
<h3 id="tham-s·ªë-h√≥a-l_t">Tham s·ªë h√≥a $L_t$</h3>
<p>C√°c gi√° tr·ªã $L_t$ v·ªõi $1 \leq t \leq T - 1$ li√™n quan ƒë·∫øn kho·∫£ng c√°ch gi·ªØa ph√¢n ph·ªëi ƒë∆∞·ª£c x·∫•p x·ªâ b·ªüi model $p_\theta$ v√† m·ªôt phi√™n b·∫£n ‚Äúd·ªÖ t√≠nh h∆°n‚Äù c·ªßa $q(\bold{x}_{t-1} | \bold{x}_t)$ l√† $q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)$ . Ta s·∫Ω ƒëi t√≠nh mean v√† variance c·ªßa ph√¢n ph·ªëi n√†y.</p>
<p>ƒê·∫ßu ti√™n, √°p d·ª•ng quy t·∫Øc Bayes th√¨</p>
<p>$$
q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)
= q(\mathbf{x}_t \vert \mathbf{x}_{t-1}, \mathbf{x}_0) \frac{ q(\mathbf{x}_{t-1} \vert \mathbf{x}_0) }{ q(\mathbf{x}_t \vert \mathbf{x}_0)}
$$</p>
<p>C·∫£ 3 ph√¢n ph·ªëi tr√™n ƒë·ªÅu l√† <strong>Gaussian distribution</strong> trong qu√° tr√¨nh forward v√† ta ƒë√£ bi·∫øt ƒë∆∞·ª£c mean, variance c·ªßa ch√∫ng. Nh·∫Øc l·∫°i m·ªôt ch√∫t: C√¥ng th·ª©c h√†m m·∫≠t ƒë·ªô x√°c su·∫•t c·ªßa Gaussian distribution $\cal{N}(\mu,\sigma)$  l√†</p>
<p>$$
f(x) = \frac{1}{\sigma \sqrt{2 \pi}} \exp \left( -\frac{1}{2} \left( \frac{x - \mu}{\sigma} \right)^2\right)
$$</p>
<p>Do ƒë√≥</p>
<p>$$
\begin{aligned}
q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) &amp;\propto \exp \left(-\frac{1}{2} \left(\frac{(\mathbf{x}_t - \sqrt{\alpha_t} \mathbf{x}_{t-1})^2}{\beta_t} + \frac{(\mathbf{x}_{t-1} - \sqrt{\bar{\alpha}_{t-1}} \mathbf{x}_0)^2}{1-\bar{\alpha}_{t-1}} - \frac{(\mathbf{x}_t - \sqrt{\bar{\alpha}_t} \mathbf{x}_0)^2}{1-\bar{\alpha}_t} \right) \right) \\
&amp;= \exp \left(-\frac{1}{2} \left(\frac{\mathbf{x}_t^2 - 2\sqrt{\alpha_t} \mathbf{x}_t \color{blue}{\mathbf{x}_{t-1}} \color{default}{+ \alpha_t} \color{red}{\mathbf{x}_{t-1}^2} }{\beta_t} + \frac{ \color{red}{\mathbf{x}_{t-1}^2} \color{default}{- 2 \sqrt{\bar{\alpha}_{t-1}} \mathbf{x}_0} \color{blue}{\mathbf{x}_{t-1}} \color{default}{+ \bar{\alpha}_{t-1} \mathbf{x}_0^2}  }{1-\bar{\alpha}_{t-1}} - \frac{(\mathbf{x}_t - \sqrt{\bar{\alpha}_t} \mathbf{x}_0)^2}{1-\bar{\alpha}_t} \right) \right) \\
&amp;= \exp \left( -\frac{1}{2} \left(  \left( \frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}} \right) \color{red} \bold{x}_{t-1}^2 \color{default} -  \left( \frac{2\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{2 \sqrt{\bar{\alpha}_{t-1}}}{1 - \bar{\alpha}_{t-1}} \bold{x}_0 \right) \color{blue}\bold{x}_{t-1} \color{default} + C(\bold{x}_t, \bold{x}_0)\right)\right)\\
\end{aligned}
$$</p>
<p>v·ªõi $C(\bold{x}_t, \bold{x}_0)$ l√† nh·ªØng ƒë·∫°i l∆∞·ª£ng kh√¥ng li√™n quan ƒë·∫øn $\bold{x}_{t-1}$ v√† c√≥ th·ªÉ ƒë∆∞·ª£c b·ªè qua.</p>
<p>Ta c·∫ßn bi·∫øn ƒë·ªïi c√¥ng th·ª©c tr√™n v·ªÅ d·∫°ng c·ªßa m·ªôt Gaussian distribution. ƒê·∫∑t</p>
<p>$$
\tilde{\beta}_t
= 1/\left(\frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}}\right)
= 1/\left(\frac{\alpha_t - \bar{\alpha}_t + \beta_t}{\beta_t(1 - \bar{\alpha}_{t-1})}\right)
= {\frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \cdot \beta_t}
$$</p>
<p>v√†</p>
<p>$$
\begin{aligned}
\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, \bold{x}_0)
&amp;= \left(\frac{\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1} }}{1 - \bar{\alpha}_{t-1}} \mathbf{x}_0\right)/\left(\frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}}\right) \\
&amp;= \left(\frac{\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1} }}{1 - \bar{\alpha}_{t-1}} \mathbf{x}_0\right) {\frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \cdot \beta_t} \\
&amp;= \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1}}\color{green}\beta_t}{1 - \bar{\alpha}_t} \color{red}\mathbf{x}_0
\end{aligned}
$$</p>
<p>T·ª´ qu√° tr√¨nh forward, ta c√≥ th·ªÉ suy ra r·∫±ng $\bold{x}_0 = \frac{1}{\sqrt{\bar{\alpha}_t}}(\mathbf{x}_t - \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon})$  v·ªõi $\boldsymbol{\epsilon} \sim \cal{N}(\bold{0}, \bold{I})$. Do ƒë√≥</p>
<p>$$
\begin{aligned}
\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, t)
&amp;= \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1}}\color{green}(1 - \alpha_t)}{1 - \bar{\alpha}_t} \color{red}\frac{1}{\sqrt{\bar{\alpha}_t}}(\mathbf{x}_t - \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}) \\
&amp;= \frac{1}{\sqrt{\alpha_t}} \left( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon} \right)
\end{aligned}
$$</p>
<p>Khi ƒë√≥ ta c√≥</p>
<p>$$
q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)
\propto \exp \left( -\frac{1}{2} \frac{\left( \bold{x}_{t-1} - \tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, t) \right)^2}{\tilde{\beta}_t} \right)
$$</p>
<p>, t·ª©c l√†</p>
<p>$$
q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)  = \cal{N}(\bold{x}_{t-1};\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, t), \tilde{\beta}_t\bold{I})
$$</p>
<p>M·∫∑t kh√°c, trong ph·∫ßn ƒë·∫∑t v·∫•n ƒë·ªÅ c·ªßa qu√° tr√¨nh reverse th√¨ ta c·∫ßn hu·∫•n luy·ªán m√¥ h√¨nh $p_\theta$ ƒë·ªÉ d·ª± ƒëo√°n gi√° tr·ªã mean $\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)$, sao cho</p>
<p>$$
p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t), \beta_t \bold{I})
$$</p>
<p>ƒêi·ªÅu n√†y nghƒ©a l√† th·ª© ta c·∫ßn quan t√¢m v·ªÅ $\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)$ l√† d·ª± ƒëo√°n ƒë∆∞·ª£c $\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, t)$, m√† c·ª• th·ªÉ h∆°n l√† <strong>d·ª± ƒëo√°n gi√° tr·ªã $\epsilon \sim \cal{N}(\bold{0}, \bold{I})$</strong> (v√¨ to√†n b·ªô nh·ªØng gi√° tr·ªã kh√°c trong $\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, t)$ ƒë·ªÅu ƒë√£ bi·∫øt v√¨ ch√∫ng l√† input c·ªßa qu√° tr√¨nh reverse). T·ª´ ƒë√≥, ta c√≥ th·ªÉ bi·ªÉu di·ªÖn</p>
<p>$$
\boldsymbol{\mu}_\theta(\mathbf{x}_t, t) = {\frac{1}{\sqrt{\alpha_t}} \left( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \color{red}\boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t) \color{default} \right)}
$$</p>
<ul>
<li>D·ª± ƒëo√°n $\epsilon_t$ c≈©ng c√≥ nghƒ©a l√† ƒëi <strong>d·ª± ƒëo√°n l∆∞·ª£ng nhi·ªÖu</strong> ƒë∆∞·ª£c th√™m v√†o $\bold{x}_{t-1}$ ƒë·ªÉ t·∫°o ra $\bold{x}_{t}$ trong qu√° tr√¨nh forward tr∆∞·ªõc ƒë√≥.</li>
</ul>
<p>Nh∆∞ v·∫≠y, th√†nh ph·∫ßn loss $L_{t-1}$ s·∫Ω tr·ªü th√†nh</p>
<p>$$
\begin{aligned}
L_{t-1}
&amp;= D_\text{KL}(q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)) \\
&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{1}{2 \| \beta_t \bold{I} \|^2_2} \| \color{blue}{\tilde{\boldsymbol{\mu}}_t(\mathbf{x}_t, \mathbf{x}_0)} - \color{green}{\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)} \color{default} \|^2 \Big] \\
&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{1}{2  \|\beta_t \bold{I} \|^2_2} \| \color{blue}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon} \Big)} - \color{green}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\boldsymbol{\epsilon}}_\theta(\mathbf{x}_t, t) \Big)} \color{default}\|^2 \Big] \\
&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{ (1 - \alpha_t)^2 }{2 \alpha_t (1 - \bar{\alpha}_t) \| \beta_t \bold{I} \|^2_2} \|\boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)\|^2 \Big]
\end{aligned}
$$</p>
<p>C√°c t√°c gi·∫£ c·ªßa DDPM cho r·∫±ng l∆∞·ª£c b·ªè ph·∫ßn tr·ªçng s·ªë s·∫Ω gi√∫p m√¥ h√¨nh h·ªçc t·ªët h∆°n. Khi ƒë√≥ ta c√≥ phi√™n b·∫£n ƒë∆°n gi·∫£n h∆°n c·ªßa $L_{t-1}$ l√†</p>
<p>$$
\begin{aligned}
L_{t-1}^\text{simple}
&amp;= \mathbb{E}_{t \sim [1, T], \mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\|\boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)\|^2 \Big] \\
&amp;= \mathbb{E}_{t \sim [1, T], \mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\|\boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\sqrt{\bar{\alpha}_t}\mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}, t)\|^2 \Big]
\end{aligned}
$$</p>
<p>, hay di·ªÖn t·∫£ d·ªÖ hi·ªÉu h∆°n th√¨ ƒë√¢y l√† <strong>Mean Squared Error</strong> gi·ªØa l∆∞·ª£ng nhi·ªÖu d·ª± ƒëo√°n v√† l∆∞·ª£ng nhi·ªÖu th·∫≠t s·ª±.</p>
<h2 id="variance-scheduler">Variance scheduler</h2>
<p>Trong c√°c ph·∫ßn tr∆∞·ªõc, ta c√≥ ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác c√°c gi√° tr·ªã variance $\beta_t$ l√† c·ªë ƒë·ªãnh v√† ch√∫ng ƒë∆∞·ª£c x√°c ƒë·ªãnh tr∆∞·ªõc b·∫±ng c√°ch s·ª≠ d·ª•ng <strong>variance chueduler.</strong></p>
<p><strong>V√¨ sao c·∫ßn d√πng ƒë·∫øn scheduler?</strong></p>
<ul>
<li>Vi·ªác s·ª≠ d·ª•ng schedule l√†m cho qu√° tr√¨nh forward c·ªßa diffusion model l√† <strong>c·ªë ƒë·ªãnh</strong> v√† <strong>c√≥ th·ªÉ x√°c ƒë·ªãnh tr∆∞·ªõc</strong>. ƒêi·ªÅu n√†y c√≥ th·ªÉ gi√∫p cho c√°c t√≠nh to√°n c·ªßa qu√° tr√¨nh reverse tr·ªü n√™n g·ªçn nh·∫π h∆°n m√† kh√¥ng l√†m ·∫£nh h∆∞·ªüng g√¨ ƒë·∫øn ƒë·ªô hi·ªáu qu·∫£ c·ªßa m√¥ h√¨nh.</li>
</ul>
<p>C√≥ nhi·ªÅu d·∫°ng schedule kh√°c nhau nh∆∞ linear, cosine. Trong paper DDPM 2020 th√¨ c√°c t√°c gi·∫£ s·ª≠ d·ª•ng <strong>linear variance scheduler</strong> v·ªõi $\beta_1 = 10^{-4}$ v√† $\beta_T = 0.02$.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 450px;" src='./images/scheduler.png'>
<p align="center" style="margin: 0; color: #888;">Minh h·ªça cho linear variance scheduler
</p>
</div>
<p>Trong paper <strong>Improved Denoising Diffusion Probabilistic Models - 2021</strong>, ng∆∞·ªùi ta cho r·∫±ng s·ª≠ d·ª•ng <strong>cosine variance scheduler</strong> s·∫Ω mang l·∫°i k·∫øt qu·∫£ t·ªët h∆°n. V·∫•n ƒë·ªÅ ch·ªß y·∫øu n·∫±m ·ªü ch·ªó v·ªõi linear th√¨ ·ªü nh·ªØng timesteps ph√≠a sau th√¨ h·∫ßu nh∆∞ ·∫£nh ƒë√£ tr·ªü th√†nh ‚Äúisotropic Gaussian distribution‚Äù (c√≥ v·∫ª √Ω l√† linear th√¨ th√™m nhi·ªÖu h∆°i b·ªã nhanh). ·ªû h√¨nh b√™n d∆∞·ªõi th√¨ h√†ng tr√™n l√† linear, h√†ng d∆∞·ªõi l√† cosine.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 300px;" src='./images/linear_vs_cosine.png'>
<p align="center" style="margin: 0; color: #888;">Linear scheduler v√† Cosine scheduler
</p>
</div>
<h2 id="qu√°-tr√¨nh-training-v√†-sampling">Qu√° tr√¨nh training v√† sampling</h2>
<p>D√π c√°c n·ªÅn t·∫£ng l√Ω thuy·∫øt b√™n d∆∞·ªõi c·ªßa diffusion model tr√¥ng r·∫•t r·ªëi nh∆∞ng qu√° tr√¨nh training v√† sampling (inference) th√¨ r·∫•t ƒë∆°n gi·∫£n.</p>
<p>ƒê·∫ßu ti√™n, ta x√©t qu√° tr√¨nh <strong>training</strong>:</p>
<ul>
<li>Ta c·∫ßn train m√¥ h√¨nh d·ª± ƒëo√°n nhi·ªÖu.</li>
<li>C√≥ m·ªôt chi ti·∫øt l√† c√°c t√°c gi·∫£ c·ªßa paper DDPM cho r·∫±ng vi·ªác training s·∫Ω hi·ªáu qu·∫£ h∆°n khi ta ch·ªçn ng·∫´u nhi√™n c√°c timestep $t$ v√† ch·ªâ d·ª± ƒëo√°n nhi·ªÖu t·∫°i timestep ƒë√≥, thay v√¨ ph·∫£i d·ª± ƒëo√°n ·ªü to√†n b·ªô timestep nh∆∞ nh·ªØng g√¨ ƒë∆∞·ª£c bi·ªÉu di·ªÖn trong h√†m loss ·ªü <a class="link" href="#x%c3%a1c-%c4%91%e1%bb%8bnh-loss-function" ><strong>ph·∫ßn 3.2</strong></a>.</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/train_algo.png'>
<p align="center" style="margin: 0; color: #888;">M√£ gi·∫£ cho qu√° tr√¨nh training
</p>
</div>
<p>Trong qu√° tr√¨nh sampling (inference) th√¨ ta s·∫Ω ch·ªçn tr∆∞·ªõc s·ªë l∆∞·ª£ng timestep t·ªëi ƒëa $T$. B·∫Øt ƒë·∫ßu t·ª´  $\bold{x}_T \sim \cal{N}(\bold{0}, \bold{I})$. T·ª´ ƒë√≥, d·∫ßn qua c√°c b∆∞·ªõc reverse th√¨:</p>
<ul>
<li>D·ª± ƒëo√°n nhi·ªÖu $\epsilon_\theta(\bold{x}_t, t)$.</li>
<li>Sample $\bold{x}_{t-1}$ v·ªõi b·∫±ng re-parameterization trick</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/sample_algo.png'>
<p align="center" style="margin: 0; color: #888;">M√£ gi·∫£ cho qu√° tr√¨nh sampling
</p>
</div>
<ul>
<li><strong>L∆∞u √Ω.</strong> Trong m√£ gi·∫£ c·ªßa qu√° tr√¨nh sampling, khi sampling $\bold{x}_0$ th√¨ ta kh√¥ng th√™m nhi·ªÖu. ƒêi·ªÅu n√†y kh·ªõp v·ªõi chi ti·∫øt b·ªè qua th√†nh ph·∫ßn loss $L_0$ ·ªü tr√™n :D</li>
</ul>
<p><strong>Minh h·ªça tr·ª±c quan</strong> cho qu√° tr√¨nh training v√† sampling:</p>
<div>
<div style="display: flex; justify-content: space-around; align-items: starts;">
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 500px"  src='./images/train_ex.png'>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 700px" src='./images/sample_ex.png'>
</div>
</div>
<h2 id="nh·∫≠n-x√©t">Nh·∫≠n x√©t</h2>
<p>Ch·ªâ v·ªõi nh·ªØng chi ti·∫øt tr√™n th√¨ c√≥ th·ªÉ n√≥i r·∫±ng diffusion models ch∆∞a th·ªÉ v∆∞·ª£t m·∫∑t GAN ƒë∆∞·ª£c v·ªÅ t·ªëc ƒë·ªô sampling c≈©ng nh∆∞ ch·∫•t l∆∞·ª£ng ·∫£nh. Ta v·∫´n c√≤n nhi·ªÅu c·∫£i ti·∫øn cho difusion models v√† nh·ªØng c·∫£i ti·∫øn n√†y ƒë√£ c√πng nhau ƒë∆∞a diffusion models l√™n c·∫°nh tranh v·ªã tr√≠ top 1 trong b√†i to√°n Image Generation, trong ƒë√≥ n·ªïi b·∫≠t l√† s·ª± xu·∫•t hi·ªán c·ªßa Stable Diffusion v·ªõi nh·ªØng ma thu·∫≠t nh∆∞ text-to-image, image-to-image v√† h∆°n th·∫ø n·ªØa!.</p>
<p>Ta s·∫Ω ƒë·ªÅ c·∫≠p ƒë·∫øn ch√∫ng trong c√°c b√†i vi·∫øt sau.</p>
<h2 id="t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</h2>
<ul>
<li>Jascha Sohl-Dickstein et al. ‚ÄúDeep Unsupervised Learning using Nonequilibrium Thermodynamics.‚Äù ICML 2015.</li>
<li>Jonathan Ho et al. ‚ÄúDenoising diffusion probabilistic models.‚Äù arxiv Preprint arxiv:2006.11239 (2020).</li>
<li><a class="link" href="https://lilianweng.github.io/posts/2021-07-11-diffusion-models/"  target="_blank" rel="noopener"
    >Lilian Wenge, What are diffusion models?</a></li>
<li><a class="link" href="https://theaisummer.com/diffusion-models/"  target="_blank" rel="noopener"
    >The AI Summer, Diffusion models</a></li>
<li><a class="link" href="https://huggingface.co/blog/annotated-diffusion"  target="_blank" rel="noopener"
    >HuggingFace&rsquo;s Blog, Annotated Diffusion</a></li>
<li><a class="link" href="https://medium.com/@steinsfu/diffusion-model-clearly-explained-cd331bd41166"  target="_blank" rel="noopener"
    >Steins, Diffusion Model Clearly Explained!</a></li>
<li><a class="link" href="https://www.youtube.com/watch?v=HoKDTa5jHvg"  target="_blank" rel="noopener"
    >Outlier, Diffusion Models | Paper Explanation | Math Explained</a></li>
<li><a class="link" href="https://www.youtube.com/watch?v=B5gfJF8mOPo"  target="_blank" rel="noopener"
    >Tanishq Abraham, Diffusions Study Group</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/diffusion/">diffusion</a>
        
            <a href="/tags/generative/">generative</a>
        
            <a href="/tags/vae/">vae</a>
        
            <a href="/tags/unet/">unet</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/mlp_mixer/">
        
        

        <div class="article-details">
            <h2 class="article-title">MLP Mixer</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/efficientnet/">
        
        

        <div class="article-details">
            <h2 class="article-title">EfficientNet (2020)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet_v2/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet V2 (2019)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/densenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">DenseNet (2018)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/cam/">
        
        

        <div class="article-details">
            <h2 class="article-title">CAM, Grad-CAM v√† Score-CAM trong CNN</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

<div id="disqus_thread"></div>

<p><b>L∆∞u √Ω.</b> N·∫øu ph·∫ßn Comment kh√¥ng load ra ƒë∆∞·ª£c th√¨ c√°c b·∫°n v√†o DNS setting c·ªßa Wifi/LAN v√† ƒë·ªïi th√†nh "8.8.8.8" nh√© (server c·ªßa Google)!</p>


<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://htrvu-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 Trong-Vu Hoang
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
