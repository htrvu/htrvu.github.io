<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Giá»›i thiá»‡u vá» sequence data, sequence models vÃ  mÃ´ hÃ¬nh RNN'>
<title>Recurrent Neural Network</title>

<link rel='canonical' href='https://htrvu.github.io/post/rnn/'>

<link rel="stylesheet" href="/scss/style.min.38e85664c6a3693af4a810d65ba9912a0751a4ee2f42b2ed7f83f842913e35c8.css"><meta property='og:title' content='Recurrent Neural Network'>
<meta property='og:description' content='Giá»›i thiá»‡u vá» sequence data, sequence models vÃ  mÃ´ hÃ¬nh RNN'>
<meta property='og:url' content='https://htrvu.github.io/post/rnn/'>
<meta property='og:site_name' content='Hoang Trong Vu'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='rnn' /><meta property='article:tag' content='sequence-data' /><meta property='article:tag' content='sequence-models' /><meta property='article:published_time' content='2023-02-15T21:42:44&#43;07:00'/><meta property='article:modified_time' content='2023-02-15T21:42:44&#43;07:00'/>
<meta name="twitter:title" content="Recurrent Neural Network">
<meta name="twitter:description" content="Giá»›i thiá»‡u vá» sequence data, sequence models vÃ  mÃ´ hÃ¬nh RNN">
    <link rel="shortcut icon" href="/neural.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu4ef57fa6d8ae56d86d9663ef18f7ace5_124758_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Hoang Trong Vu</a></h1>
            <h2 class="site-description">Keep going!</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/htrvu'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/htrvu/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"/> <rect x="4" y="4" width="16" height="16" rx="2" /> <line x1="8" y1="11" x2="8" y2="16" /> <line x1="8" y1="8" x2="8" y2="8.01" /> <line x1="12" y1="16" x2="12" y2="11" /> <path d="M16 16v-3a2 2 0 0 0 -4 0" /> </svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#sÆ¡-lÆ°á»£c-vá»-natural-language-processing">SÆ¡ lÆ°á»£c vá» Natural Language Processing</a></li>
    <li><a href="#sequence-data-sequence-models">Sequence data, sequence models</a>
      <ol>
        <li><a href="#sequence-data">Sequence data</a></li>
        <li><a href="#sequence-models">Sequence models</a></li>
      </ol>
    </li>
    <li><a href="#recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</a>
      <ol>
        <li><a href="#háº¡n-cháº¿-cá»§a-mÃ´-hÃ¬nh-multi-layers-percentron">Háº¡n cháº¿ cá»§a mÃ´ hÃ¬nh Multi-layers Percentron</a></li>
        <li><a href="#Ã½-tÆ°á»Ÿng-cá»§a-rnn">Ã tÆ°á»Ÿng cá»§a RNN</a></li>
        <li><a href="#sá»±-chia-sáº»-trá»ng-sá»‘-giá»¯a-cÃ¡c-thá»i-Ä‘iá»ƒm">Sá»± chia sáº» trá»ng sá»‘ giá»¯a cÃ¡c thá»i Ä‘iá»ƒm</a></li>
        <li><a href="#quÃ¡-trÃ¬nh-feed-forward">QuÃ¡ trÃ¬nh feed-forward</a></li>
        <li><a href="#back-propagation-through-time-bptt">Back-propagation Through Time (BPTT)</a></li>
        <li><a href="#váº¥n-Ä‘á»-vanishing-vÃ -exploding-gradients-trong-rnn">Váº¥n Ä‘á» vanishing vÃ  exploding gradients trong RNN</a></li>
        <li><a href="#quÃ¡-trÃ¬nh-huáº¥n-luyá»‡n-vÃ -sá»­-dá»¥ng-mÃ´-hÃ¬nh-rnn-trong-thá»±c-táº¿">QuÃ¡ trÃ¬nh huáº¥n luyá»‡n vÃ  sá»­ dá»¥ng mÃ´ hÃ¬nh RNN trong thá»±c táº¿</a></li>
      </ol>
    </li>
    <li><a href="#cÃ¡c-dáº¡ng-mÃ´-hÃ¬nh-rnn">CÃ¡c dáº¡ng mÃ´ hÃ¬nh RNN</a></li>
    <li><a href="#tÃ i-liá»‡u-tham-kháº£o">TÃ i liá»‡u tham kháº£o</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/nlp/" style="background-color: #2a9d8f; color: #fff;">
                Natual Language Processing
            </a>
        
            <a href="/categories/dl/" style="background-color: #2a9d8f; color: #fff;">
                Deep Learning
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/rnn/">Recurrent Neural Network</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Giá»›i thiá»‡u vá» sequence data, sequence models vÃ  mÃ´ hÃ¬nh RNN
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 15, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    15 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>ÄÃ¢y lÃ  bÃ i viáº¿t Ä‘áº§u tiÃªn cá»§a mÃ¬nh trong lÄ©nh vá»±c Natural Language Processing (Xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn). NÃ³ sáº½ khÃ¡ dÃ i vÃ¬ mÃ¬nh Ä‘Ã£ trÃ¬nh bÃ y ká»¹ quÃ¡ trÃ¬nh <strong>back-propagation</strong>. Mong cÃ¡c báº¡n Ä‘á»c háº¿t nhÃ©! ğŸ˜€</p>
<h2 id="sÆ¡-lÆ°á»£c-vá»-natural-language-processing">SÆ¡ lÆ°á»£c vá» Natural Language Processing</h2>
<p>BÃªn cáº¡nh <strong>Computer Vision</strong> (CV - Thá»‹ giÃ¡c mÃ¡y tÃ­nh) thÃ¬ <strong>Natural Language Processing</strong> (NLP - Xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn) cÅ©ng lÃ  má»™t máº£ng ráº¥t quan trá»ng vÃ  Ä‘Æ°á»£c nghiÃªn cá»©u rá»™ng rÃ£i trong Deep Learning. CÃ¡c sáº£n pháº©m ná»•i tiáº¿ng trÃªn tháº¿ giá»›i liÃªn quan Ä‘áº¿n chá»¯ viáº¿t, giá»ng nÃ³i, Ã¢m thanh nhÆ° Google Dá»‹ch, Google Assistant, Siri, Alexa, ChatGPTâ€¦ Ä‘á»u lÃ  cÃ¡c thÃ nh quáº£ cá»§a viá»‡c Ã¡p dá»¥ng NLP vÃ o thá»±c táº¿.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 500px;" src='./images/nlp.png'>
<p align="center" style="margin: 0; color: #888;">
Nguá»“n: <a href="https://datasciencedojo.com/wp-content/uploads/MicrosoftTeams-image-34-1-1030x1030.jpg">Data Science Dojo</a>
</p>
</div>
<p>Tuy NLP vÃ  CV lÃ  hai lÄ©nh vá»±c nghiÃªn cá»©u khÃ¡c nhau nhÆ°ng chÃºng cÃ³ nhá»¯ng má»‘i quan há»‡ ráº¥t Ä‘áº·c biá»‡t vÃ  thÃº vá»‹. Ta cÃ³ thá»ƒ Ä‘em Ã½ tÆ°á»Ÿng cá»§a CV qua NLP, vÃ­ dá»¥ nhÆ° sá»­ dá»¥ng phÃ©p toÃ¡n convolution trong xá»­ lÃ½ tÃ­nh toÃ¡n vá»›i vÄƒn báº£n, vÃ  ngÆ°á»£c láº¡i lÃ  Ä‘em Ã½ tÆ°á»Ÿng cá»§a NLP qua CV, mÃ  Ä‘áº·c biá»‡t ná»•i tiáº¿ng gáº§n Ä‘Ã¢y lÃ  sá»­ dá»¥ng Attention, Transformer trong CV. Viá»‡c káº¿t há»£p NLP vÃ  CV Ä‘Ã£ táº¡o ra nhiá»u káº¿t quáº£ ráº¥t ná»•i báº­t trong cÃ¡c á»©ng dá»¥ng nhÆ° Image Captioning, Text-to-Image.</p>
<ul>
<li>Náº¿u mÃ  ká»ƒ tÃªn ra thÃ¬ ta cÃ³ thá»ƒ nháº¯c Ä‘áº¿n ngay mÃ´ hÃ¬nh ráº¥t áº£o diá»‡u lÃ  <strong>Stable Diffusion</strong> ğŸ˜€</li>
</ul>
<p>Ná»n mÃ³ng cá»§a NLP báº¯t nguá»“n tá»« nhá»¯ng mÃ´ hÃ¬nh toÃ¡n há»c vÃ  xÃ¡c suáº¥t, Ä‘áº·c biá»‡t lÃ  <strong>mÃ´ hÃ¬nh Markov</strong>. Khi Deep Learning báº¯t Ä‘áº§u phÃ¡t triá»ƒn máº¡nh máº½, ta Ä‘Ã£ cÃ³ thÃªm nhá»¯ng mÃ´ hÃ¬nh khÃ¡c vá»›i Ä‘á»™ hiá»‡u quáº£ ráº¥t tuyá»‡t vá»i nhÆ° <strong>Recurrent Neural Network</strong>, <strong>Sequence to Sequence</strong>, <strong>Attention Mechanism</strong> vÃ  <strong>Transformer</strong>. Trong Ä‘Ã³, Recurrent Neural Network, hay lÃ  RNN, lÃ  sá»± khá»Ÿi Ä‘áº§u thÃº vá»‹ cá»§a Deep Learning trong NLP. MÃ´ hÃ¬nh RNN cÅ©ng lÃ  sáº½ chá»§ Ä‘á» cá»§a bÃ i viáº¿t nÃ y.</p>
<h2 id="sequence-data-sequence-models">Sequence data, sequence models</h2>
<h3 id="sequence-data">Sequence data</h3>
<p>Ta cÃ³ thá»ƒ hiá»ƒu <strong>sequence data</strong> (dá»¯ liá»‡u dáº¡ng chuá»—i) lÃ  dáº¡ng dá»¯ liá»‡u mÃ  cÃ¡c giÃ¡ trá»‹ trong Ä‘Ã³ Ä‘Æ°á»£c sáº¯p xáº¿p theo má»™t trÃ¬nh tá»± khÃ´ng gian/thá»i gian nÃ o Ä‘Ã³ vÃ  chÃºng cÃ³ nhá»¯ng má»‘i liÃªn há»‡ vá»›i nhau. VÃ­ dá»¥:</p>
<ul>
<li><strong>VÄƒn báº£n:</strong> ÄÃ¢y lÃ  dáº¡ng sequence data ráº¥t phá»• biáº¿n. CÃ¡c tá»« trong cÃ¢u táº¥t nhiÃªn lÃ  Ä‘Æ°á»£c sáº¯p xáº¿p theo má»™t trÃ¬nh tá»± nháº¥t Ä‘á»‹nh Ä‘á»ƒ táº¡o ra Ä‘Æ°á»£c má»™t cÃ¢u cÃ³ nghÄ©a</li>
<li><strong>Ã‚m thanh:</strong> Má»™t Ä‘oáº¡n ghi Ã¢m giá»ng nÃ³i, má»™t báº£n nháº¡c</li>
<li><strong>Video:</strong> CÃ¡c frame (áº£nh) cá»§a video theo cÃ¡c thá»i Ä‘iá»ƒm liÃªn tiáº¿p nhau</li>
<li><strong>Sinh há»c:</strong> TrÃ¬nh tá»± cá»§a má»™t Ä‘oáº¡n gen, dÃ£y protein,â€¦</li>
<li><strong>Time series:</strong> CÃ¡c dá»¯ liá»‡u thu tháº­p theo thá»i gian nhÆ° thá»‹ trÆ°á»ng chá»©ng khoÃ¡n</li>
</ul>
<div>
<div style="display: flex; justify-content: space-around;">
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/data_text.png'>
<p align="center" style="margin: 0; color: #888;">VÄƒn báº£n</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_audio.png'>
<p align="center" style="margin: 0; color: #888;">
Ã‚m thanh</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_video.png'>
<p align="center" style="margin: 0; color: #888;">
Video</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_time-series.png'>
<p align="center" style="margin: 0; color: #888;">
Time series</p>
</div>
</div>
<p><strong>LÆ°u Ã½:</strong></p>
<ul>
<li>
<p>TÃ¹y theo dáº¡ng dá»¯ liá»‡u mÃ  ta sáº½ cÃ³ cÃ¡ch â€œsá»‘ hÃ³a&quot; chÃºng sao cho cÃ¡c mÃ´ hÃ¬nh cÃ³ thá»ƒ tiáº¿n hÃ nh â€œhá»câ€ Ä‘Æ°á»£c. VÃ¬ sao cáº§n pháº£i lÃ m váº­y? VÃ¬ mÃ¡y tÃ­nh chá»‰ hiá»ƒu Ä‘Æ°á»£c nhá»¯ng con sá»‘, mÃ  cá»¥ thá»ƒ hÆ¡n lÃ  chá»‰ hiá»ƒu 0 vÃ  1 ğŸ˜€</p>
</li>
<li>
<p>Trong bÃ i viáº¿t nÃ y, mÃ¬nh sáº½ táº¡m thá»i chÆ°a Ä‘á» cáº­p Ä‘áº¿n Ä‘iá»u nÃ y. Äá»‘i vá»›i dá»¯ liá»‡u dáº¡ng vÄƒn báº£n, cÃ¡c báº¡n cÃ³ thá»ƒ xem bÃ i viáº¿t tiáº¿p theo vá» <strong>Word Embeddings</strong> nhÃ©.</p>
</li>
</ul>
<h3 id="sequence-models">Sequence models</h3>
<p>KhÃ¡c vá»›i cÃ¡c dá»¯ liá»‡u dáº¡ng hÃ¬nh áº£nh mÃ  ta thÆ°á»ng tháº¥y trong Computer Vision, Natural Language Processing sáº½ táº­p trung vÃ o viá»‡c xá»­ lÃ½ cÃ¡c dá»¯ liá»‡u dáº¡ng chuá»—i. Do Ä‘Ã³, cÃ¡c mÃ´ hÃ¬nh trong NLP thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <strong>sequence model.</strong></p>
<p>Äá»ƒ cÃ³ sá»± phÃ¢n biá»‡t rÃµ hÆ¡n giá»¯a sequence model vÃ  cÃ¡c model trong CV, ta thÆ°á»ng xÃ©t Ä‘áº¿n <strong>input</strong> vÃ  <strong>cÃ¡c thá»©c tÃ­nh toÃ¡n</strong> cá»§a chÃºng.</p>
<ul>
<li>Vá»›i model trong CV, input cá»§a ta sáº½ lÃ  <strong>má»™t</strong> áº£nh xÃ¡m hoáº·c lÃ  RGB (ma tráº­n nhiá»u chiá»u). Trong quÃ¡ trÃ¬nh tÃ­nh toÃ¡n, ta cÃ³ thá»ƒ thá»±c hiá»‡n <strong>tÃ­nh toÃ¡n song song</strong> trÃªn cÃ¡c giÃ¡ trá»‹ Ä‘áº§u vÃ o.</li>
<li>Trong khi Ä‘Ã³, sequence model sáº½ nháº­n vÃ o input lÃ  dá»¯ liá»‡u á»Ÿ <strong>cÃ¡c giai Ä‘oáº¡n khÃ¡c nhau</strong>, má»—i giai Ä‘oáº¡n thÃ¬ ta sáº½ cÃ³ má»™t vector hay má»™t ma tráº­n nhiá»u chiá»u. Khi tÃ­nh toÃ¡n, ta sáº½ <strong>tÃ­nh toÃ¡n tuáº§n tá»± tá»«ng giai Ä‘oáº¡n má»™t</strong>.
<ul>
<li>VÃ­ dá»¥, vá»›i input lÃ  má»™t cÃ¢u vÄƒn báº£n thÃ¬ tá»«ng giai Ä‘oáº¡n sáº½ á»©ng vá»›i tá»«ng tá»«, má»—i tá»« cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi má»™t sá»‘ hoáº·c má»™t vector.</li>
</ul>
</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 280px;" src='./images/sequence-model.png'>
<p align="center" style="margin: 0; color: #888;"> Minh há»a sequence model <br>
Nguá»“n: <a href="https://jeddy92.github.io/images/ts_intro/seq2seq_lang.png">Jeddy92</a>
</p>
</div>
<p>Sequence models Ä‘Æ°á»£c sá»­ dá»¥ng cho nhiá»u bÃ i toÃ¡n phá»• biáº¿n trong thá»±c táº¿ nhÆ° sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 350px;" src='./images/sequence-model-2.png'>
<p align="center" style="margin: 0; color: #888;">
Nguá»“n: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<h2 id="recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</h2>
<p>Äá»ƒ cho dá»… diá»…n Ä‘áº¡t, ta xÃ©t má»™t bÃ i toÃ¡n trong NLP vá»›i input lÃ  má»™t cÃ¢u cÃ³ Ä‘á»™ dÃ i $T_x$, tá»« á»©ng vá»›i vá»‹ trÃ­ thá»© $i$ Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng vector $x^{&lt; i &gt;}$, output lÃ  má»™t cÃ¢u cÃ³ Ä‘á»™ dÃ i $T_y$ vÃ  nhá»¯ng tá»« tÆ°Æ¡ng tá»©ng lÃ  $y^{&lt; i &gt;}$.</p>
<ul>
<li>ThÃ´ng thÆ°á»ng thÃ¬ ta sáº½ giáº£ sá»­ luÃ´n $T_x = T_y$ Ä‘á»ƒ bÃ i toÃ¡n Ä‘Æ¡n giáº£n hÆ¡n má»™t chÃºt. Äá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c thÃ¬ chá»‰ Ä‘Æ¡n giáº£n lÃ  padding/truncate Ä‘á»ƒ chÃºng báº±ng nhau thÃ´i ğŸ˜œ</li>
<li>Náº¿u báº¡n Ä‘ang tháº¯c máº¯c lÃ  cÃ³ bÃ i toÃ¡n nÃ o dáº¡ng nhÆ° nÃ y thÃ¬ hÃ£y nghÄ© Ä‘áº¿n Machine Translation.</li>
</ul>
<h3 id="háº¡n-cháº¿-cá»§a-mÃ´-hÃ¬nh-multi-layers-percentron">Háº¡n cháº¿ cá»§a mÃ´ hÃ¬nh Multi-layers Percentron</h3>
<p>Má»™t cÃ¡ch tá»± nhiÃªn, ta hoÃ n toÃ n cÃ³ thá»ƒ xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh <strong>MLP</strong> (Multi-layers Perceptron) vá»›i input layer cÃ³ $T_x$ neurons, output layer cÃ³ $T_y$ neurons nhÆ° sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/mlp.png'>
<p align="center" style="margin: 0; color: #888;"> Minh há»a sá»­ dá»¥ng MLP cho bÃ i toÃ¡n <br>
Nguá»“n: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<p>Vá»›i MLP thÃ¬ ta Ä‘Ã£ thá»±c hiá»‡n tÃ­nh toÃ¡n song song, tá»©c lÃ  tÃ­nh luÃ´n trÃªn toÃ n bá»™ input vÃ  cho ra output. Tuy nhiÃªn, cÃ¡ch tiáº¿p nÃ y cÃ³ nhá»¯ng háº¡n cháº¿ khÃ¡ nghiÃªm trá»ng:</p>
<ul>
<li>KhÃ´ng pháº£i cÃ¢u input nÃ o cÅ©ng cÃ³ Ä‘á»™ dÃ i $T_x$ nhÆ° nhau, output cÅ©ng váº­y.</li>
<li>Náº¿u cÃ¡c cÃ¢u nÃ y cÃ³ nhiá»u tá»« thÃ¬ mÃ´ hÃ¬nh sáº½ cÃ³ ráº¥t nhiá»u trá»ng sá»‘.</li>
<li>MÃ´ hÃ¬nh khÃ´ng há»c Ä‘Æ°á»£c sá»± â€œchia sáº» Ä‘áº·c trÆ°ngâ€ giá»¯a cÃ¡c vá»‹ trÃ­ khÃ¡c nhau trong cÃ¢u. VÃ­ dá»¥, cá»¥m tá»« â€œtÃ´i Ä‘i há»câ€ xuáº¥t hiá»‡n trong cÃ¢u input thÃ¬ cho dÃ¹ nÃ³ báº¯t Ä‘áº§u á»Ÿ vá»‹ trÃ­ nÃ o Ä‘i ná»¯a, ta váº«n nÃªn há»c Ä‘Æ°á»£c cÃ¡c Ä‘áº·c trÆ°ng ráº¥t tÆ°Æ¡ng tá»± nhau. ÄÃ¢y cÅ©ng lÃ  má»™t trong nhá»¯ng váº¥n Ä‘á» dáº«n Ä‘áº¿n CNN Ä‘Æ°á»£c Ã¡p dá»¥ng nhiá»u hÆ¡n vÃ o dá»¯ liá»‡u áº£nh chá»© khÃ´ng pháº£i lÃ  MLP.</li>
</ul>
<h3 id="Ã½-tÆ°á»Ÿng-cá»§a-rnn">Ã tÆ°á»Ÿng cá»§a RNN</h3>
<p>VÃ¬ sequence data cÃ³ má»™t Ä‘áº·c Ä‘iá»ƒm lÃ  <strong>thá»© tá»± cá»§a cÃ¡c giÃ¡ trá»‹ trong input</strong> lÃ  ráº¥t quan trá»ng nÃªn ta thÆ°á»ng thiÃªn vá» hÆ°á»›ng <strong>láº§n lÆ°á»£t xá»­ lÃ½ trÃªn tá»«ng vá»‹ trÃ­ má»™t</strong>. Äá»“ng thá»i, khi Ä‘i Ä‘áº¿n cÃ¡c vá»‹ trÃ­ sau thÃ¬ ta cÅ©ng nÃªn cÃ³ nhá»¯ng <strong>thÃ´ng tin Ä‘Ã£ trÃ­ch xuáº¥t Ä‘Æ°á»£c tá»« cÃ¡c vá»‹ trÃ­ trÆ°á»›c</strong>. Ã tÆ°á»Ÿng cá»§a RNN chÃ­nh lÃ  nhÆ° váº­y.</p>
<p>SÆ¡ lÆ°á»£c vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a RNN Ä‘Æ°á»£c mÃ´ táº£ nhÆ° sau:</p>
<ul>
<li>Vá»›i Ä‘iá»u kiá»‡n giáº£ sá»­ $T_x=T_y$, ta sáº½ thá»±c hiá»‡n tÃ­nh toÃ¡n $T_x$ láº§n, táº¡i thá»i Ä‘iá»ƒm (hay lÃ  vá»‹ trÃ­) thá»© $i$ thÃ¬ tá»« $x^{&lt; i &gt;}$ (input) ta tÃ­nh ra $y^{&lt; i &gt;}$ (output).</li>
<li>HÆ¡n ná»¯a, Ä‘á»ƒ thá»±c hiá»‡n thao tÃ¡c <strong>lÆ°u giá»¯ cÃ¡c thÃ´ng tin cho Ä‘áº¿n thá»i Ä‘iá»ƒm hiá»‡n táº¡i</strong> vÃ  Ä‘Æ°a nÃ³ qua cÃ¡c thá»i Ä‘iá»ƒm sau, ta cÅ©ng cáº§n tÃ­nh thÃªm má»™t giÃ¡ trá»‹ lÃ   $h^{&lt; i &gt;}$ (giáº£ sá»­ luÃ´n $h^{&lt;0&gt;} = 0$). LÃºc nÃ y, ta gá»i $h^{&lt; i &gt;}$ lÃ  <strong>tráº¡ng thÃ¡i áº©n</strong> (hidden state)</li>
<li>NhÆ° váº­y, táº¡i má»—i thá»i Ä‘iá»ƒm thÃ¬ ta cáº§n tÃ­nh ra $h^{&lt; i &gt;}$ vÃ  $y^{&lt; i &gt;}$, dá»±a vÃ o 2 input lÃ  $x^{&lt; i &gt;}$ vÃ  thÃ´ng tin tá»« nhá»¯ng thá»i Ä‘iá»ƒm trÆ°á»›c Ä‘Æ°á»£c tá»•ng há»£p táº¡i $h^{&lt;i - 1&gt;}$.</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/rnn-1.png'>
<p align="center" style="margin: 0; color: #888;"> Minh há»a ban Ä‘áº§u cho RNN<br>
Nguá»“n: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<p>NhÃ¬n vÃ o hÃ¬nh trÃªn, ta cÃ³ thá»ƒ suy ra ráº±ng nhá»¯ng trá»ng sá»‘ mÃ  RNN cáº§n há»c lÃ  ma tráº­n trá»ng sá»‘ cá»§a hidden layer á»Ÿ cÃ¡c thá»i Ä‘iá»ƒm.</p>
<p>Äá»ƒ thuáº­n tiá»‡n cho cÃ¡c pháº§n sau, ta sáº½ quy Æ°á»›c kÃ­ hiá»‡u nhÆ° sau:</p>
<ul>
<li>Vector input, output vÃ  hidden state táº¡i thá»i Ä‘iá»ƒm $t$ láº§n lÆ°á»£t lÃ  $\bold{X}_t \in \mathbb{R}^d$, $\bold{O}_t  \in \mathbb{R}^o$ vÃ  $\bold{H}_t \in \mathbb{R}^h$.</li>
<li>Ma tráº­n trá»ng sá»‘ cho phÃ©p tÃ­nh liÃªn quan giá»¯a $\bold{X}_t$ vÃ  $\bold{H}_t$ lÃ  $\bold{W}^{t}_{ xh } \in \mathbb{R}^{ h \times d }$.</li>
<li>TÆ°Æ¡ng tá»± nhÆ° trÃªn, ta cÃ³ $\bold{W}^{t}_{hh}  \in \mathbb{R}^{h \times h}$ vÃ  $\bold{W}^{t}_{ho}  \in \mathbb{R}^{o \times h}$.</li>
</ul>
<p>Khi Ä‘Ã³, ta cÃ³ thá»ƒ biá»ƒu diá»…n RNN nhÆ° sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 230px;" src='./images/rnn-2.png'>
<p align="center" style="margin: 0; color: #888;"> Nguá»“n: <a href="https://d2l.ai/_images/rnn.svg">Dive into DL</a>
</p>
</div>
<h3 id="sá»±-chia-sáº»-trá»ng-sá»‘-giá»¯a-cÃ¡c-thá»i-Ä‘iá»ƒm">Sá»± chia sáº» trá»ng sá»‘ giá»¯a cÃ¡c thá»i Ä‘iá»ƒm</h3>
<p>Qua mÃ´ táº£ vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a RNN á»Ÿ pháº§n trÆ°á»›c, ta tháº¥y ráº±ng náº¿u á»Ÿ má»—i thá»i Ä‘iá»ƒm mÃ  ta cáº§n dÃ¹ng má»™t bá»™ trá»ng sá»‘ khÃ¡c nhau thÃ¬ lÆ°á»£ng tham sá»‘ cá»§a mÃ´ hÃ¬nh RNN sáº½ lá»›n khÃ´ng kÃ©m gÃ¬ MLP á»Ÿ pháº§n <strong>3.1</strong> ğŸ˜€</p>
<p>Trong RNN, giá»¯a cÃ¡c thá»i Ä‘iá»ƒm sáº½ cÃ³ sá»± <strong>chia sáº» trá»ng sá»‘</strong>, tá»©c lÃ  má»i thá»i Ä‘iá»ƒm Ä‘á»u dÃ¹ng cÃ¹ng má»™t bá»™ trá»ng sá»‘ $(\bold{W}_{xh}, \bold{W}_{hh}, \bold{W}_{ho})$ Ä‘á»ƒ tÃ­nh toÃ¡n $\bold{O}_t$ vÃ  $\bold{H}_t$. Lá»£i Ã­ch cá»§a viá»‡c chia sáº» trá»ng sá»‘ bao gá»“m:</p>
<ul>
<li>Sá»‘ lÆ°á»£ng trá»ng sá»‘ trong RNN sáº½ giáº£m Ä‘i ráº¥t nhiá»u láº§n so vá»›i MLP</li>
<li>Ta cÅ©ng cÃ³ thá»ƒ kháº¯c phá»¥c Ä‘Æ°á»£c nhÆ°á»£c Ä‘iá»ƒm cá»§a MLP trong viá»‡c â€œchia sáº» Ä‘áº·c trÆ°ngâ€ giá»¯a cÃ¡c vá»‹ trÃ­ khÃ¡c nhau trong cÃ¢u.</li>
</ul>
<p>Khi Ä‘Ã³, tá»« hÃ¬nh á»Ÿ pháº§n <strong>3.2</strong>, sau khi chÃº thÃ­ch vá»‹ trÃ­ cÃ¡c ma tráº­n trá»ng sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng thÃ¬ ta cÃ³ hÃ¬nh sau:</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 230px;" src='./images/rnn-3.png'>
</p>
<p>Thay vÃ¬ pháº£i biá»ƒu diá»…n Ä‘á»§ cÃ¡c thá»i Ä‘iá»ƒm, ta cÃ³ thá»ƒ viáº¿t gá»n láº¡i RNN nhÆ° hÃ¬nh bÃªn dÆ°á»›i:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/rnn-4.png'>
<p align="center" style="margin: 0; color: #888;"> Biá»ƒu diá»…n gá»n hÆ¡n cá»§a Recurrent Neural Network
</p>
</div>
<h3 id="quÃ¡-trÃ¬nh-feed-forward">QuÃ¡ trÃ¬nh feed-forward</h3>
<p>Äáº§u tiÃªn, ta sáº½ xem hidden state ban Ä‘áº§u lÃ  $\bold{H}_0 = \bold{0}$. Äá»ƒ Ä‘Æ¡n giáº£n, ta sáº½ bá» qua cÃ¡c giÃ¡ trá»‹ bias á»©ng vá»›i $\bold{H}_t$ vÃ  $\bold{O}_t$. Khi Ä‘Ã³, quÃ¡ trÃ¬nh feed-forward táº¡i thá»i Ä‘iá»ƒm $t &gt; 0$ diá»…n ra nhÆ° sau:</p>
<p>$$\begin{equation}
\bold{H}_t = \phi_h (\bold{W}_{xh} \bold{X}_t + \bold{W}_{hh} \bold{H}_{t-1})
\end{equation}$$
$$\begin{equation}
\bold{O}_t = \phi_o (\bold{W}_{ho} \bold{H}_t)
\end{equation}$$</p>
<p>, vá»›i $\phi_h$ vÃ  $\phi_o$ lÃ  cÃ¡c activation function. ThÃ´ng thÆ°á»ng, $\phi_h$ lÃ  $ReLU$  hoáº·c $\tanh$ vÃ  $\phi_o$ thÆ°á»ng lÃ  $\text{softmax}$.</p>
<p>NhÆ° váº­y, tá»« $\bold{X}_{t}$ vÃ  $\bold{H}_{t-1}$ ta sáº½ tÃ­nh Ä‘Æ°á»£c $\bold{H}_{t}$, vÃ  tá»« $\bold{H}_{t}$ thÃ¬ ta sáº½ tÃ­nh Ä‘Æ°á»£c $\bold{O}_{t}$.</p>
<p><strong>Nháº­n xÃ©t.</strong></p>
<ul>
<li>
<p>Ta cÃ³ thá»ƒ nháº­n tháº¥y ráº¥t rÃµ sá»± khÃ¡c biá»‡t giá»¯a feed-forward trong RNN so vá»›i MLP. Vá»›i MLP thÃ¬ nÃ³ chá»‰ cáº§n hai phÃ©p toÃ¡n (xem nhÆ° pháº§n hidden layers chá»‰ cÃ³ 1 layer) lÃ  cÃ³ luÃ´n káº¿t quáº£ cuá»‘i cÃ¹ng:</p>
<p>$$\begin{equation*}
\bold{H} = \phi_h (\bold{X} \bold{W}_{xh}^\top  )
\end{equation*}$$
$$\begin{equation*}
\bold{O} = \phi_o (\bold{H} \bold{W}^\top _{ho} )
\end{equation*}$$</p>
<p>, vá»›i $\bold{X} \in \mathbb{R}^{n \times d}$ vÃ  $\bold{H}  \in \mathbb{R}^{n \times h}$ lÃ  cÃ¡c ma tráº­n á»©ng vá»›i toÃ n bá»™ giÃ¡ trá»‹ input vÃ  hidden state (trong RNN thÃ¬ $\bold{X}_t$ vÃ  $\bold{H}_t$ lÃ  cÃ¡c vector).</p>
</li>
</ul>
<h3 id="back-propagation-through-time-bptt">Back-propagation Through Time (BPTT)</h3>
<p>Khi mÃ  feed-forward trong RNN diá»…n ra khÃ¡c vá»›i MLP thÃ¬ táº¥t nhiÃªn lÃ  back-propagation cÅ©ng khÃ¡c ğŸ˜€ Thuáº­t toÃ¡n back-propagation trong sequence model Ä‘Æ°á»£c gá»i lÃ  <strong>Back-propagation Through Time</strong> (BPTT).</p>
<p>Äáº§u tiÃªn, ta sáº½ Ä‘á» cáº­p Ä‘áº¿n <strong>cost function</strong>. Giáº£ sá»­ output cá»§a RNN táº¡i thá»i Ä‘iá»ƒm $t$ lÃ  $\bold{O}_t$ vÃ  label lÃ  $\bold{Y}_t$. KÃ­ hiá»‡u $l(\bold{O}_t, \bold{Y}_t)$ lÃ  loss táº¡i thá»i Ä‘iá»ƒm $t$. Khi Ä‘Ã³ cost function cá»§a ta lÃ </p>
<p>$$\begin{equation}
L= \sum_{i=1}^{T} l(\bold{O}_t, \bold{Y}_t)
\end{equation}$$</p>
<ul>
<li>Thá»±c ra lÃ  ta cÃ³ chia $L$ cho $T$ ná»¯a nhÆ°ng Ä‘á»ƒ cho gá»n thÃ¬ thÃ´i bá» qua ğŸ˜œ</li>
</ul>
<p>Nhá»¯ng gÃ¬ ta cáº§n thá»±c hiá»‡n trong quÃ¡ trÃ¬nh BPTT lÃ  tÃ­nh Ä‘áº¡o hÃ m cá»§a $L$ theo cÃ¡c ma tráº­n trá»ng sá»‘ $\bold{W}_{xh}$, $\bold{W}_{hh}$ vÃ  $\bold{W}_{ho}$. Äiá»u Ä‘áº·c biá»‡t á»Ÿ Ä‘Ã¢y lÃ  trong quÃ¡ trÃ¬nh feed-forward thÃ¬ $\bold{H}_{t-1}$ sáº½ láº¡i Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ tÃ­nh $\bold{H}_t$ chá»© nÃ³ khÃ´ng Ä‘i má»™t â€œmáº¡ch&quot; tá»« $\bold{X}$ Ä‘áº¿n $\bold{H}$ rá»“i tá»« $\bold{H}$ Ä‘áº¿n $\bold{O}$ nhÆ° trong feed-forward cá»§a MLP thÃ´ng thÆ°á»ng.</p>
<p>Äá»ƒ cÃ´ng thá»©c Ä‘Æ°á»£c gá»n nháº¹ hÆ¡n, ta sáº½ giáº£ sá»­ luÃ´n cÃ¡c activation function $\phi_h$ vÃ  $\phi_o$ lÃ  hÃ m Ä‘á»“ng nháº¥t, tá»©c lÃ </p>
<p>$$\phi_h(\bold{x}) = \phi_o(\bold{x}) = \bold{x}$$</p>
<p><strong>QuÃ¡ trÃ¬nh BPPT diá»…n ra nhÆ° sau:</strong></p>
<ul>
<li>
<p>Äáº§u tiÃªn, dá»… nháº¥t lÃ  tÃ­nh Ä‘áº¡o hÃ m $L$ theo $\bold{W}_{ho}$ ğŸ˜€ Tá»« biá»ƒu thá»©c $(3)$ thÃ¬ ta cÃ³ ngay</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{O}_{t}} = \frac{\partial l(\bold{O}_t, \bold{Y}_t)}{\partial \bold{O}_{t}}
\end{equation}$$</p>
<p>Do Ä‘Ã³, káº¿t há»£p $(2)$ vÃ  $(4)$ thÃ¬</p>
<p>$$
\frac{\partial L}{\partial \bold{W}_{ho}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{O}_{t}} \frac{\partial \bold{O}_t}{\partial \bold{W}_{ho}}  \right ) = \sum_{t=1}^{T} \left (  \frac{\partial L}{\partial \bold{O}_{t}}\bold{H}_t^\top \right )
$$</p>
<p><strong>LÆ°u Ã½.</strong> CÃ¡ch tÃ­nh giÃ¡ trá»‹ cá»§a $\dfrac{\partial l(\bold{O}_t, \bold{Y}_t)}{\partial \bold{O}_{t}}$ trong biá»ƒu thá»©c $(4)$ sáº½ phá»¥ thuá»™c vÃ o hÃ m $l$ vÃ  thÆ°á»ng thÃ¬ nÃ³ ráº¥t dá»… tÃ­nh ğŸ˜œ</p>
</li>
<li>
<p>Tiáº¿p theo, ta cÃ³ nháº­n xÃ©t sau:</p>
<ul>
<li>$\bold{H}_T$ chá»‰ tham gia vÃ o má»™t biá»ƒu thá»©c trong quÃ¡ trÃ¬nh feed-forward (Ä‘á»ƒ tÃ­nh ra $\bold{O}_T$)</li>
<li>$\bold{H}_{t}$ vá»›i $t &lt; T$ thÃ¬ tham gia vÃ o hai biá»ƒu thá»©c (tÃ­nh $\bold{H}_{t +1}$ vÃ  $\bold{O}_t$)</li>
</ul>
<p>Do Ä‘Ã³, cÃ¡ch tÃ­nh $\dfrac{\partial L}{\partial \bold{H}_{t}}$ sáº½ cÃ³ sá»± khÃ¡c biá»‡t tÃ¹y theo giÃ¡ trá»‹ $t$.</p>
<ul>
<li>
<p>Vá»›i $t = T$: Tá»« $(2)$ vÃ  $(4)$ ta cÃ³</p>
<p>$$
\frac{\partial L}{\partial \bold{H}_{T}} = \frac{\partial L}{\partial \bold{O}_{T}} \frac{\partial \bold{O}_T}{\partial \bold{H}_{T}} = \bold{W}_{ho}^\top \frac{\partial L}{\partial \bold{O}_{T}}
$$</p>
</li>
<li>
<p>Vá»›i $t &lt; T$: Tá»« $(1), (2)$ vÃ  $(4)$ thÃ¬</p>
<p>$$
\frac{\partial L}{\partial \bold{H}_{t}} = \frac{\partial L}{\partial \bold{O}_{t}} \frac{\partial \bold{O}_t}{\partial \bold{H}_{t}} + \frac{\partial L}{\partial \bold{H}_{t+1}} \frac{\partial \bold{H}_{t+1}}{\partial \bold{H}_{t}} = \bold{W}_{ho}^\top \frac{\partial L}{\partial \bold{O}_{t}}  + \bold{W}_{hh}^\top \frac{\partial L}{\partial \bold{H}_{t+1}}
$$</p>
<p>Cá»© tiáº¿p tá»¥c biáº¿n Ä‘á»•i tiáº¿p vá»›i $\dfrac{\partial L}{\partial \bold{H}_{t+1}}$ vÃ  cá»© nhÆ° tháº¿ cho Ä‘áº¿n $T$, ta sáº½ cÃ³</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \mathbf{H}_t}= \sum_{i=t}^T {\left(\mathbf{W}_{hh}^\top\right)}^{T-i} \mathbf{W}_{ho}^\top \frac{\partial L}{\partial \mathbf{O}_{T+t-i}}
\end{equation}$$</p>
<p>Äá»ƒ Ã½ ráº±ng biá»ƒu thá»©c $(5)$ cÅ©ng Ä‘Ãºng vá»›i $t = T$.</p>
</li>
</ul>
<p>Váº­y tá»« $(1)$ vÃ  $(5)$ thÃ¬</p>
</li>
</ul>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{W}_{xh}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \frac{\partial \bold{H}_t}{\partial \bold{W}_{xh}} \right ) =  = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \bold{X}_t^\top \right )
\end{equation}$$</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{W}_{hh}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \frac{\partial \bold{H}_t}{\partial \bold{W}_{hh}} \right ) =  = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \bold{H}_{t-1}^\top \right )
\end{equation}$$</p>
<h3 id="váº¥n-Ä‘á»-vanishing-vÃ -exploding-gradients-trong-rnn">Váº¥n Ä‘á» vanishing vÃ  exploding gradients trong RNN</h3>
<p>Qua cÃ¡c biá»ƒu thá»©c $(6)$ vÃ  $(7)$, ta tháº¥y ráº±ng náº¿u giÃ¡ trá»‹ $T$ lá»›n (tá»©c lÃ  cÃ¢u input gá»“m ráº¥t nhiá»u tá»«) thÃ¬ sáº½ cÃ³ hai trÆ°á»ng há»£p xáº£y ra Ä‘á»‘i vá»›i cÃ¡c giÃ¡ trá»‹ gradient $\dfrac{\partial L}{\partial \bold{W}_{xh}}$ vÃ  $\dfrac{\partial L}{\partial \bold{W}_{ho}}$:</p>
<ul>
<li><strong>Vanishing:</strong> Trong quÃ¡ trÃ¬nh tÃ­nh $\left ( \bold{W}_{hh}^\top \right ) ^ {T-i}$ cÃ³ nhiá»u giÃ¡ trá»‹ nhá» hÆ¡n 1 Ä‘Æ°á»£c nhÃ¢n vá»›i nhau.</li>
<li><strong>Exploding:</strong> NgÆ°á»£c láº¡i (lá»›n hÆ¡n 1).</li>
</ul>
<p>Ta cÃ³ má»™t giáº£i phÃ¡p Ä‘á»ƒ háº¡n cháº¿ hiá»‡n tÆ°á»£ng nÃ y lÃ  <strong>Truncated BPTT</strong>, tá»©c lÃ  ta chá»‰ lan truyá»n gradients Ä‘áº¿n má»™t tráº¡ng thÃ¡i cÃ¡ch tráº¡ng thÃ¡i hiá»‡n táº¡i má»™t khoáº£ng nÃ o Ä‘Ã³ thÃ´i chá»© khÃ´ng lan truyá»n toÃ n bá»™.</p>
<p>Äá»‘i vá»›i hiá»‡n tÆ°á»£ng vanishing trong RNN, ta cÃ³ thá»ƒ diá»…n Ä‘áº¡t nÃ³ má»™t cÃ¡ch vÄƒn vá»Ÿ hÆ¡n lÃ  mÃ´ hÃ¬nh Ä‘Ã£ bá»‹ â€œquÃªnâ€ nhá»¯ng thÃ´ng tin tÃ­ch lÅ©y tá»« phÃ­a trÆ°á»›c.</p>
<ul>
<li>
<p>VÃ­ dá»¥, ta cÃ³ hai cÃ¢u sau:</p>
<ol>
<li>The <strong>cat</strong>, which always â€¦ (very long descriptions) â€¦, <strong>was</strong> very cute</li>
<li>The <strong>cats</strong>, which always â€¦ (very long descriptions) â€¦, <strong>were</strong> very cute</li>
</ol>
<p>ThÃ´ng thÆ°á»ng, Ä‘á»™ng tá»« to-be á»Ÿ trÆ°á»›c â€œvery cuteâ€ sáº½ phá»¥ thuá»™c vÃ o danh tá»« á»Ÿ Ä‘áº§u cÃ¢u (â€catâ€ hay â€œcatsâ€). Tuy nhiÃªn, náº¿u RNN bá»‹ vanishing gradient thÃ¬ nÃ³ sáº½ khÃ´ng thá»ƒ nhá»› Ä‘Æ°á»£c trÆ°á»›c Ä‘Ã³ lÃ  má»™t con mÃ¨o hay nhiá»u con mÃ¨o Ä‘á»ƒ mÃ  chá»n Ä‘á»™ng tá»« to-be cho Ä‘Ãºng. ğŸ˜€</p>
</li>
</ul>
<p>Yáº¿u tá»‘ nÃ y Ä‘Ã£ má»Ÿ ra má»™t hÆ°á»›ng phÃ¡t triá»ƒn cho RNN lÃ  ta sáº½ cá»‘ gáº¯ng tÃ­nh toÃ¡n thÃªm nhá»¯ng phÃ©p toÃ¡n khÃ¡c Ä‘á»ƒ duy trÃ¬ Ä‘Æ°á»£c cÃ¡c thÃ´ng tin tá»« trÆ°á»›c, tá»« phÃ­a xa mÃ  RNN hiá»‡n táº¡i khÃ´ng thá»ƒ ghi nhá»› Ä‘Æ°á»£c. Tá»« Ä‘Ã³, ta cÃ³ sá»± ra Ä‘á»i cá»§a <strong>Gated Recurrent Unit (GRU)</strong> vÃ  <strong>Long Short-Term Memory (LSTM)</strong>.</p>
<h3 id="quÃ¡-trÃ¬nh-huáº¥n-luyá»‡n-vÃ -sá»­-dá»¥ng-mÃ´-hÃ¬nh-rnn-trong-thá»±c-táº¿">QuÃ¡ trÃ¬nh huáº¥n luyá»‡n vÃ  sá»­ dá»¥ng mÃ´ hÃ¬nh RNN trong thá»±c táº¿</h3>
<p>Äá»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh ML hay CNN thÃ´ng thÆ°á»ng, nhá»¯ng thao tÃ¡c diá»…n ra trong bÆ°á»›c huáº¥n luyá»‡n (training) vÃ  sá»­ dá»¥ng trong thá»±c táº¿ (testing) lÃ  ráº¥t giá»‘ng nhau: Tá»« má»™t intput cho ra má»™t output vÃ  chá»‰ nhÆ° váº­y lÃ  xong (ta táº¡m bá» qua back-propagation).</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/cnn.jpg'>
<p align="center" style="margin: 0; color: #888;"> Nguá»“n: <a href="https://towardsdatascience.com/convolutional-neural-network-a-step-by-step-guide-a8b4c88d6943">Towards Data Science</a>
</p>
</div>
<p>Tuy nhiÃªn, trong RNN thÃ¬ training vÃ  testing sáº½ cÃ³ sá»± khÃ¡c biá»‡t khÃ¡ rÃµ rá»‡t. Äá»‘i vá»›i training, á»Ÿ má»—i thá»i Ä‘iá»ƒm thÃ¬ ta sáº½ luÃ´n cÃ³ input vÃ  label á»©ng vá»›i thá»i Ä‘iá»ƒm Ä‘Ã³. Tuy nhiÃªn, trong testing thÃ¬ ta chá»‰ cÃ³ duy nháº¥t input cho <strong>thá»i Ä‘iá»ƒm Ä‘áº§u tiÃªn</strong> vÃ  input cá»§a nhá»¯ng thá»i Ä‘iá»ƒm sau chÃ­nh lÃ  output cá»§a thá»i Ä‘iá»ƒm trÆ°á»›c Ä‘Ã³.</p>
<p>Ta xÃ©t vÃ­ dá»¥ vá»›i bÃ i toÃ¡n xÃ¢y dá»±ng mÃ´ hÃ¬nh RNN sinh ra Ä‘oáº¡n vÄƒn báº£n nhÆ° sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/rnn-practice.png'>
<p align="center" style="margin: 0; color: #888;"> Nguá»“n: <a href="https://ml-lectures.org/_images/generative_RNN2.png">ML Lectures</a>
</p>
</div>
<ul>
<li>
<p>Trong training, tá»« má»™t cÃ¢u cÃ³ $T_x$ tá»« lÃ  $x_1, x_2,&hellip;, x_{T_x}$ thÃ¬ ta sáº½ táº¡o ra Ä‘Æ°á»£c má»™t training sample vá»›i $(T_x + 1)$ thá»i Ä‘iá»ƒm, á»Ÿ thá»i Ä‘iá»ƒm $t$ thÃ¬ input vÃ  label láº§n lÆ°á»£t lÃ  $x_t$ vÃ  $x_{t+1}$ (giáº£ sá»­  $x_0$ vÃ  $x_{T_x + 1}$ láº§n lÆ°á»£t lÃ  cÃ¡c tá»« Ä‘áº·c biá»‡t nháº±m bÃ¡o hiá»‡u báº¯t Ä‘áº§u vÃ  káº¿t thÃºc Ä‘oáº¡n).</p>
</li>
<li>
<p>Trong testing, tá»« má»™t tá»« ban Ä‘áº§u lÃ  $x_1$ (thÆ°á»ng lÃ  tá»« báº¯t Ä‘áº§u Ä‘oáº¡n vÄƒn báº£n), ta sáº½ cÃ³ testing sample vá»›i 1 thá»i Ä‘iá»ƒm. Sau khi qua RNN, ta cÃ³ thÃªm tá»« má»›i lÃ  $y_1$. Sau Ä‘Ã³, $y_1$ Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° lÃ  input cá»§a thá»i Ä‘iá»ƒm thá»© hai, Ä‘Æ°a qua RNN vÃ  cÃ³ tiáº¿p tá»« $y_2$. QuÃ¡ trÃ¬nh cá»© láº·p láº¡i cho Ä‘áº¿n khi Ä‘Ã£ sinh ra Ä‘á»§ sá»‘ tá»« chÃºng ta cáº§n hoáº·c lÃ  tá»« Ä‘Æ°á»£c sinh ra chÃ­nh lÃ  tá»« káº¿t thÃºc Ä‘oáº¡n.</p>
</li>
</ul>
<h2 id="cÃ¡c-dáº¡ng-mÃ´-hÃ¬nh-rnn">CÃ¡c dáº¡ng mÃ´ hÃ¬nh RNN</h2>
<p>ChÃºng ta Ä‘á»ƒ Ã½ ráº±ng dáº¡ng mÃ´ hÃ¬nh RNN mÃ¬nh Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ pháº§n trÆ°á»›c Ä‘ang nháº­n input lÃ  má»™t cÃ¢u vÃ  output cá»§a nÃ³ cÅ©ng lÃ  má»™t cÃ¢u. Dáº¡ng mÃ´ hÃ¬nh nÃ y cÃ²n gá»i lÃ  <strong>many-to-many.</strong> TÃ¹y vÃ o bÃ i toÃ¡n cáº§n giáº£i quyáº¿t mÃ  ta cÃ³ cÃ¡c dáº¡ng nhÆ° sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 350px;" src='./images/rnn-types.png'>
<p align="center" style="margin: 0; color: #888;"> CÃ¡c dáº¡ng cá»§a mÃ´ hÃ¬nh RNN<br>
Nguá»“n: <a href="https://static.javatpoint.com/tutorial/tensorflow/images/tensorflow-types-of-rnn.png](https://static.javatpoint.com/tutorial/tensorflow/images/tensorflow-types-of-rnn.png">Javatpoint</a>
</p>
</div>
<ul>
<li><strong>One-to-one:</strong> CÃ¡i nÃ y thÃ¬ ráº¥t thÆ°á»ng tháº¥y, vÃ­ dá»¥ nhÆ° Image Classification.</li>
<li><strong>One-to-many:</strong> CÃ³ thá»ƒ láº¥y vÃ­ dá»¥ nhÆ° bÃ i toÃ¡n sinh ra vÄƒn báº£n hoáº·c Ã¢m nháº¡c. Ta cung cáº¥p input lÃ  má»™t tá»« báº¥t kÃ¬ vÃ  mÃ´ hÃ¬nh sáº½ táº¡o ra tá»« káº¿ tiáº¿p, ta láº¡i Ä‘em tá»« nÃ y vÃ o lÃ m input Ä‘á»ƒ cÃ³ tá»« tiáº¿p theo.</li>
<li><strong>Many-to-one:</strong> BÃ i toÃ¡n Sentiment Analysis, Mail fitlering,â€¦</li>
<li><strong>Many-to-many:</strong> Chá»§ yáº¿u lÃ  bÃ i toÃ¡n Machine Translation.</li>
</ul>
<h2 id="tÃ i-liá»‡u-tham-kháº£o">TÃ i liá»‡u tham kháº£o</h2>
<ul>
<li><a class="link" href="https://arxiv.org/abs/1912.05911"  target="_blank" rel="noopener"
    >Robin M. Schmidtm, Recurrent Neural Networks (RNNs): A gentle Introduction and Overview</a></li>
<li><a class="link" href="https://d2l.ai/chapter_recurrent-neural-networks/rnn.html"  target="_blank" rel="noopener"
    >Dive into DL, Recurrent Neural Network</a></li>
<li><a class="link" href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning"  target="_blank" rel="noopener"
    >DeepLearning.AI, Deep Learning Specialization, 5. Sequence Models</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/rnn/">rnn</a>
        
            <a href="/tags/sequence-data/">sequence-data</a>
        
            <a href="/tags/sequence-models/">sequence-models</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/efficientnet/">
        
        

        <div class="article-details">
            <h2 class="article-title">EfficientNet (2020)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet_v2/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet V2 (2019)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/densenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">DenseNet (2018)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/cam/">
        
        

        <div class="article-details">
            <h2 class="article-title">CAM, Grad-CAM vÃ  Score-CAM trong CNN</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet (2017)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

<div id="disqus_thread"></div>

<p><b>LÆ°u Ã½.</b> Náº¿u pháº§n Comment khÃ´ng load ra Ä‘Æ°á»£c thÃ¬ cÃ¡c báº¡n vÃ o DNS setting cá»§a Wifi/LAN vÃ  Ä‘á»•i thÃ nh "8.8.8.8" nhÃ© (server cá»§a Google)!</p>


<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://htrvu-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 Hoang Trong Vu
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
