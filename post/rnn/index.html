<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Gi·ªõi thi·ªáu v·ªÅ sequence data, sequence models v√† m√¥ h√¨nh RNN'>
<title>Recurrent Neural Network</title>

<link rel='canonical' href='https://htrvu.github.io/post/rnn/'>

<link rel="stylesheet" href="/scss/style.min.38e85664c6a3693af4a810d65ba9912a0751a4ee2f42b2ed7f83f842913e35c8.css"><meta property='og:title' content='Recurrent Neural Network'>
<meta property='og:description' content='Gi·ªõi thi·ªáu v·ªÅ sequence data, sequence models v√† m√¥ h√¨nh RNN'>
<meta property='og:url' content='https://htrvu.github.io/post/rnn/'>
<meta property='og:site_name' content='Hoang Trong Vu'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='rnn' /><meta property='article:tag' content='sequence-data' /><meta property='article:tag' content='sequence-models' /><meta property='article:published_time' content='2023-02-15T21:42:44&#43;07:00'/><meta property='article:modified_time' content='2023-02-15T21:42:44&#43;07:00'/>
<meta name="twitter:title" content="Recurrent Neural Network">
<meta name="twitter:description" content="Gi·ªõi thi·ªáu v·ªÅ sequence data, sequence models v√† m√¥ h√¨nh RNN">
    <link rel="shortcut icon" href="/neural.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu4ef57fa6d8ae56d86d9663ef18f7ace5_124758_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Hoang Trong Vu</a></h1>
            <h2 class="site-description">Keep going!</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/htrvu'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/htrvu/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"/> <rect x="4" y="4" width="16" height="16" rx="2" /> <line x1="8" y1="11" x2="8" y2="16" /> <line x1="8" y1="8" x2="8" y2="8.01" /> <line x1="12" y1="16" x2="12" y2="11" /> <path d="M16 16v-3a2 2 0 0 0 -4 0" /> </svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#s∆°-l∆∞·ª£c-v·ªÅ-natural-language-processing">S∆° l∆∞·ª£c v·ªÅ Natural Language Processing</a></li>
    <li><a href="#sequence-data-sequence-models">Sequence data, sequence models</a>
      <ol>
        <li><a href="#sequence-data">Sequence data</a></li>
        <li><a href="#sequence-models">Sequence models</a></li>
      </ol>
    </li>
    <li><a href="#recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</a>
      <ol>
        <li><a href="#h·∫°n-ch·∫ø-c·ªßa-m√¥-h√¨nh-multi-layers-percentron">H·∫°n ch·∫ø c·ªßa m√¥ h√¨nh Multi-layers Percentron</a></li>
        <li><a href="#√Ω-t∆∞·ªüng-c·ªßa-rnn">√ù t∆∞·ªüng c·ªßa RNN</a></li>
        <li><a href="#s·ª±-chia-s·∫ª-tr·ªçng-s·ªë-gi·ªØa-c√°c-th·ªùi-ƒëi·ªÉm">S·ª± chia s·∫ª tr·ªçng s·ªë gi·ªØa c√°c th·ªùi ƒëi·ªÉm</a></li>
        <li><a href="#qu√°-tr√¨nh-feed-forward">Qu√° tr√¨nh feed-forward</a></li>
        <li><a href="#back-propagation-through-time-bptt">Back-propagation Through Time (BPTT)</a></li>
        <li><a href="#v·∫•n-ƒë·ªÅ-vanishing-v√†-exploding-gradients-trong-rnn">V·∫•n ƒë·ªÅ vanishing v√† exploding gradients trong RNN</a></li>
      </ol>
    </li>
    <li><a href="#c√°c-d·∫°ng-m√¥-h√¨nh-rnn">C√°c d·∫°ng m√¥ h√¨nh RNN</a></li>
    <li><a href="#t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/nlp/" style="background-color: #2a9d8f; color: #fff;">
                Natual Language Processing
            </a>
        
            <a href="/categories/dl/" style="background-color: #2a9d8f; color: #fff;">
                Deep Learning
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/rnn/">Recurrent Neural Network</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Gi·ªõi thi·ªáu v·ªÅ sequence data, sequence models v√† m√¥ h√¨nh RNN
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 15, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    14 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>ƒê√¢y l√† b√†i vi·∫øt ƒë·∫ßu ti√™n c·ªßa m√¨nh trong lƒ©nh v·ª±c Natural Language Processing (X·ª≠ l√Ω ng√¥n ng·ªØ t·ª± nhi√™n). N√≥ s·∫Ω kh√° d√†i v√¨ m√¨nh ƒë√£ tr√¨nh b√†y k·ªπ qu√° tr√¨nh <strong>back-propagation</strong>. Mong c√°c b·∫°n ƒë·ªçc h·∫øt nh√©! üòÄ</p>
<h2 id="s∆°-l∆∞·ª£c-v·ªÅ-natural-language-processing">S∆° l∆∞·ª£c v·ªÅ Natural Language Processing</h2>
<p>B√™n c·∫°nh <strong>Computer Vision</strong> (CV - Th·ªã gi√°c m√°y t√≠nh) th√¨ <strong>Natural Language Processing</strong> (NLP - X·ª≠ l√Ω ng√¥n ng·ªØ t·ª± nhi√™n) c≈©ng l√† m·ªôt m·∫£ng r·∫•t quan tr·ªçng v√† ƒë∆∞·ª£c nghi√™n c·ª©u r·ªông r√£i trong Deep Learning. C√°c s·∫£n ph·∫©m n·ªïi ti·∫øng tr√™n th·∫ø gi·ªõi li√™n quan ƒë·∫øn ch·ªØ vi·∫øt, gi·ªçng n√≥i, √¢m thanh nh∆∞ Google D·ªãch, Google Assistant, Siri, Alexa, ChatGPT‚Ä¶ ƒë·ªÅu l√† c√°c th√†nh qu·∫£ c·ªßa vi·ªác √°p d·ª•ng NLP v√†o th·ª±c t·∫ø.</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 500px;" src='./images/nlp.png'>
<p align="center" style="margin: 0; color: #888;">
Ngu·ªìn: <a href="https://datasciencedojo.com/wp-content/uploads/MicrosoftTeams-image-34-1-1030x1030.jpg">Data Science Dojo</a>
</p>
</div>
<p>Tuy NLP v√† CV l√† hai lƒ©nh v·ª±c nghi√™n c·ª©u kh√°c nhau nh∆∞ng ch√∫ng c√≥ nh·ªØng m·ªëi quan h·ªá r·∫•t ƒë·∫∑c bi·ªát v√† th√∫ v·ªã. Ta c√≥ th·ªÉ ƒëem √Ω t∆∞·ªüng c·ªßa CV qua NLP, v√≠ d·ª• nh∆∞ s·ª≠ d·ª•ng ph√©p to√°n convolution trong x·ª≠ l√Ω t√≠nh to√°n v·ªõi vƒÉn b·∫£n, v√† ng∆∞·ª£c l·∫°i l√† ƒëem √Ω t∆∞·ªüng c·ªßa NLP qua CV, m√† ƒë·∫∑c bi·ªát n·ªïi ti·∫øng g·∫ßn ƒë√¢y l√† s·ª≠ d·ª•ng Attention, Transformer trong CV. Vi·ªác k·∫øt h·ª£p NLP v√† CV ƒë√£ t·∫°o ra nhi·ªÅu k·∫øt qu·∫£ r·∫•t n·ªïi b·∫≠t trong c√°c ·ª©ng d·ª•ng nh∆∞ Image Captioning, Text-to-Image.</p>
<ul>
<li>N·∫øu m√† k·ªÉ t√™n ra th√¨ ta c√≥ th·ªÉ nh·∫Øc ƒë·∫øn ngay m√¥ h√¨nh r·∫•t ·∫£o di·ªáu l√† <strong>Stable Diffusion</strong> üòÄ</li>
</ul>
<p>N·ªÅn m√≥ng c·ªßa NLP b·∫Øt ngu·ªìn t·ª´ nh·ªØng m√¥ h√¨nh to√°n h·ªçc v√† x√°c su·∫•t, ƒë·∫∑c bi·ªát l√† <strong>m√¥ h√¨nh Markov</strong>. Khi Deep Learning b·∫Øt ƒë·∫ßu ph√°t tri·ªÉn m·∫°nh m·∫Ω, ta ƒë√£ c√≥ th√™m nh·ªØng m√¥ h√¨nh kh√°c v·ªõi ƒë·ªô hi·ªáu qu·∫£ r·∫•t tuy·ªát v·ªùi nh∆∞ <strong>Recurrent Neural Network</strong>, <strong>Sequence to Sequence</strong>, <strong>Attention Mechanism</strong> v√† <strong>Transformer</strong>. Trong ƒë√≥, Recurrent Neural Network, hay l√† RNN, l√† s·ª± kh·ªüi ƒë·∫ßu th√∫ v·ªã c·ªßa Deep Learning trong NLP. M√¥ h√¨nh RNN c≈©ng l√† s·∫Ω ch·ªß ƒë·ªÅ c·ªßa b√†i vi·∫øt n√†y.</p>
<h2 id="sequence-data-sequence-models">Sequence data, sequence models</h2>
<h3 id="sequence-data">Sequence data</h3>
<p>Ta c√≥ th·ªÉ hi·ªÉu <strong>sequence data</strong> (d·ªØ li·ªáu d·∫°ng chu·ªói) l√† d·∫°ng d·ªØ li·ªáu m√† c√°c gi√° tr·ªã trong ƒë√≥ ƒë∆∞·ª£c s·∫Øp x·∫øp theo m·ªôt tr√¨nh t·ª± kh√¥ng gian/th·ªùi gian n√†o ƒë√≥ v√† ch√∫ng c√≥ nh·ªØng m·ªëi li√™n h·ªá v·ªõi nhau. V√≠ d·ª•:</p>
<ul>
<li><strong>VƒÉn b·∫£n:</strong> ƒê√¢y l√† d·∫°ng sequence data r·∫•t ph·ªï bi·∫øn. C√°c t·ª´ trong c√¢u t·∫•t nhi√™n l√† ƒë∆∞·ª£c s·∫Øp x·∫øp theo m·ªôt tr√¨nh t·ª± nh·∫•t ƒë·ªãnh ƒë·ªÉ t·∫°o ra ƒë∆∞·ª£c m·ªôt c√¢u c√≥ nghƒ©a</li>
<li><strong>√Çm thanh:</strong> M·ªôt ƒëo·∫°n ghi √¢m gi·ªçng n√≥i, m·ªôt b·∫£n nh·∫°c</li>
<li><strong>Video:</strong> C√°c frame (·∫£nh) c·ªßa video theo c√°c th·ªùi ƒëi·ªÉm li√™n ti·∫øp nhau</li>
<li><strong>Sinh h·ªçc:</strong> Tr√¨nh t·ª± c·ªßa m·ªôt ƒëo·∫°n gen, d√£y protein,‚Ä¶</li>
<li><strong>Time series:</strong> C√°c d·ªØ li·ªáu thu th·∫≠p theo th·ªùi gian nh∆∞ th·ªã tr∆∞·ªùng ch·ª©ng kho√°n</li>
</ul>
<div>
<div style="display: flex; justify-content: space-around;">
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/data_text.png'>
<p align="center" style="margin: 0; color: #888;">VƒÉn b·∫£n</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_audio.png'>
<p align="center" style="margin: 0; color: #888;">
√Çm thanh</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_video.png'>
<p align="center" style="margin: 0; color: #888;">
Video</p>
</div>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px"  src='./images/data_time-series.png'>
<p align="center" style="margin: 0; color: #888;">
Time series</p>
</div>
</div>
<p><strong>L∆∞u √Ω:</strong></p>
<ul>
<li>
<p>T√πy theo d·∫°ng d·ªØ li·ªáu m√† ta s·∫Ω c√≥ c√°ch ‚Äús·ªë h√≥a&quot; ch√∫ng sao cho c√°c m√¥ h√¨nh c√≥ th·ªÉ ti·∫øn h√†nh ‚Äúh·ªçc‚Äù ƒë∆∞·ª£c. V√¨ sao c·∫ßn ph·∫£i l√†m v·∫≠y? V√¨ m√°y t√≠nh ch·ªâ hi·ªÉu ƒë∆∞·ª£c nh·ªØng con s·ªë, m√† c·ª• th·ªÉ h∆°n l√† ch·ªâ hi·ªÉu 0 v√† 1 üòÄ</p>
</li>
<li>
<p>Trong b√†i vi·∫øt n√†y, m√¨nh s·∫Ω t·∫°m th·ªùi ch∆∞a ƒë·ªÅ c·∫≠p ƒë·∫øn ƒëi·ªÅu n√†y. ƒê·ªëi v·ªõi d·ªØ li·ªáu d·∫°ng vƒÉn b·∫£n, c√°c b·∫°n c√≥ th·ªÉ xem b√†i vi·∫øt ti·∫øp theo v·ªÅ <strong>Word Embeddings</strong> nh√©.</p>
</li>
</ul>
<h3 id="sequence-models">Sequence models</h3>
<p>Kh√°c v·ªõi c√°c d·ªØ li·ªáu d·∫°ng h√¨nh ·∫£nh m√† ta th∆∞·ªùng th·∫•y trong Computer Vision, Natural Language Processing s·∫Ω t·∫≠p trung v√†o vi·ªác x·ª≠ l√Ω c√°c d·ªØ li·ªáu d·∫°ng chu·ªói. Do ƒë√≥, c√°c m√¥ h√¨nh trong NLP th∆∞·ªùng ƒë∆∞·ª£c g·ªçi l√† <strong>sequence model.</strong></p>
<p>ƒê·ªÉ c√≥ s·ª± ph√¢n bi·ªát r√µ h∆°n gi·ªØa sequence model v√† c√°c model trong CV, ta th∆∞·ªùng x√©t ƒë·∫øn <strong>input</strong> v√† <strong>c√°c th·ª©c t√≠nh to√°n</strong> c·ªßa ch√∫ng.</p>
<ul>
<li>V·ªõi model trong CV, input c·ªßa ta s·∫Ω l√† <strong>m·ªôt</strong> ·∫£nh x√°m ho·∫∑c l√† RGB (ma tr·∫≠n nhi·ªÅu chi·ªÅu). Trong qu√° tr√¨nh t√≠nh to√°n, ta c√≥ th·ªÉ th·ª±c hi·ªán <strong>t√≠nh to√°n song song</strong> tr√™n c√°c gi√° tr·ªã ƒë·∫ßu v√†o.</li>
<li>Trong khi ƒë√≥, sequence model s·∫Ω nh·∫≠n v√†o input l√† d·ªØ li·ªáu ·ªü <strong>c√°c giai ƒëo·∫°n kh√°c nhau</strong>, m·ªói giai ƒëo·∫°n th√¨ ta s·∫Ω c√≥ m·ªôt vector hay m·ªôt ma tr·∫≠n nhi·ªÅu chi·ªÅu. Khi t√≠nh to√°n, ta s·∫Ω <strong>t√≠nh to√°n tu·∫ßn t·ª± t·ª´ng giai ƒëo·∫°n m·ªôt</strong>.
<ul>
<li>V√≠ d·ª•, v·ªõi input l√† m·ªôt c√¢u vƒÉn b·∫£n th√¨ t·ª´ng giai ƒëo·∫°n s·∫Ω ·ª©ng v·ªõi t·ª´ng t·ª´, m·ªói t·ª´ c√≥ th·ªÉ ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·ªüi m·ªôt s·ªë ho·∫∑c m·ªôt vector.</li>
</ul>
</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 280px;" src='./images/sequence-model.png'>
<p align="center" style="margin: 0; color: #888;"> Minh h·ªça sequence model <br>
Ngu·ªìn: <a href="https://jeddy92.github.io/images/ts_intro/seq2seq_lang.png">Jeddy92</a>
</p>
</div>
<p>Ta c√≥ minh h·ªça input v√† output c·ªßa c√°c sequence model trong m·ªôt v√†i b√†i to√°n ph·ªï bi·∫øn nh∆∞ sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 350px;" src='./images/sequence-model-2.png'>
<p align="center" style="margin: 0; color: #888;"> Minh h·ªça sequence model <br>
Ngu·ªìn: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<h2 id="recurrent-neural-network-rnn">Recurrent Neural Network (RNN)</h2>
<p>ƒê·ªÉ cho d·ªÖ di·ªÖn ƒë·∫°t, ta s·∫Ω x√©t m·ªôt b√†i to√°n trong NLP v·ªõi input l√† m·ªôt c√¢u c√≥ ƒë·ªô d√†i $T_x$, t·ª´ ·ª©ng v·ªõi v·ªã tr√≠ th·ª© $i$ ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·∫±ng vector $x^{&lt; i &gt;}$, output l√† m·ªôt c√¢u c√≥ ƒë·ªô d√†i $T_y$ v√† nh·ªØng t·ª´ t∆∞∆°ng t·ª©ng l√† $y^{&lt; i &gt;}$.</p>
<ul>
<li>Th√¥ng th∆∞·ªùng, ta s·∫Ω gi·∫£ s·ª≠ $T_x = T_y$ ƒë·ªÉ b√†i to√°n ƒë∆°n gi·∫£n h∆°n m·ªôt ch√∫t. ƒê·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c th√¨ ch·ªâ ƒë∆°n gi·∫£n l√† padding c√°c gi√° tr·ªã nh∆∞ s·ªë 0 v√†o ƒë·ªÉ ch√∫ng b·∫±ng nhau th√¥i üòú</li>
<li>N·∫øu b·∫°n ƒëang th·∫Øc m·∫Øc l√† c√≥ b√†i to√°n n√†o d·∫°ng nh∆∞ n√†y th√¨ h√£y nghƒ© ƒë·∫øn Machine Translation.</li>
</ul>
<h3 id="h·∫°n-ch·∫ø-c·ªßa-m√¥-h√¨nh-multi-layers-percentron">H·∫°n ch·∫ø c·ªßa m√¥ h√¨nh Multi-layers Percentron</h3>
<p>M·ªôt c√°ch t·ª± nhi√™n, ta ho√†n to√†n c√≥ th·ªÉ x√¢y d·ª±ng m·ªôt m√¥ h√¨nh <strong>MLP</strong> (Multi-layers Perceptron) v·ªõi input layer c√≥ $T_x$ neurons, output layer c√≥ $T_y$ neurons nh∆∞ sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/mlp.png'>
<p align="center" style="margin: 0; color: #888;"> Minh h·ªça s·ª≠ d·ª•ng MLP cho b√†i to√°n <br>
Ngu·ªìn: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<p>V·ªõi MLP th√¨ ta ƒë√£ th·ª±c hi·ªán t√≠nh to√°n song song, t·ª©c l√† t√≠nh lu√¥n tr√™n to√†n b·ªô input v√† cho ra output. Tuy nhi√™n, c√°ch ti·∫øp n√†y c√≥ nh·ªØng h·∫°n ch·∫ø kh√° nghi√™m tr·ªçng:</p>
<ul>
<li>Kh√¥ng ph·∫£i c√¢u input n√†o c≈©ng c√≥ ƒë·ªô d√†i $T_x$ nh∆∞ nhau, output c≈©ng v·∫≠y.</li>
<li>N·∫øu c√°c c√¢u n√†y c√≥ nhi·ªÅu t·ª´ th√¨ m√¥ h√¨nh s·∫Ω c√≥ r·∫•t nhi·ªÅu tr·ªçng s·ªë.</li>
<li>M√¥ h√¨nh kh√¥ng h·ªçc ƒë∆∞·ª£c s·ª± ‚Äúchia s·∫ª ƒë·∫∑c tr∆∞ng‚Äù gi·ªØa c√°c v·ªã tr√≠ kh√°c nhau trong c√¢u. V√≠ d·ª•, c·ª•m t·ª´ ‚Äút√¥i ƒëi h·ªçc‚Äù xu·∫•t hi·ªán trong c√¢u input th√¨ cho d√π n√≥ b·∫Øt ƒë·∫ßu ·ªü v·ªã tr√≠ n√†o ƒëi n·ªØa, ta v·∫´n n√™n h·ªçc ƒë∆∞·ª£c c√°c ƒë·∫∑c tr∆∞ng r·∫•t t∆∞∆°ng t·ª± nhau. ƒê√¢y c≈©ng l√† m·ªôt trong nh·ªØng v·∫•n ƒë·ªÅ d·∫´n ƒë·∫øn CNN ƒë∆∞·ª£c √°p d·ª•ng nhi·ªÅu h∆°n v√†o d·ªØ li·ªáu ·∫£nh ch·ª© kh√¥ng ph·∫£i l√† MLP.</li>
</ul>
<h3 id="√Ω-t∆∞·ªüng-c·ªßa-rnn">√ù t∆∞·ªüng c·ªßa RNN</h3>
<p>V√¨ sequence data c√≥ m·ªôt ƒë·∫∑c ƒëi·ªÉm l√† <strong>th·ª© t·ª± c·ªßa c√°c gi√° tr·ªã trong input</strong> l√† r·∫•t quan tr·ªçng n√™n ta th∆∞·ªùng thi√™n v·ªÅ h∆∞·ªõng <strong>l·∫ßn l∆∞·ª£t x·ª≠ l√Ω tr√™n t·ª´ng v·ªã tr√≠ m·ªôt</strong>. ƒê·ªìng th·ªùi, khi ƒëi ƒë·∫øn c√°c v·ªã tr√≠ sau th√¨ ta c≈©ng n√™n c√≥ nh·ªØng <strong>th√¥ng tin ƒë√£ tr√≠ch xu·∫•t ƒë∆∞·ª£c t·ª´ c√°c v·ªã tr√≠ tr∆∞·ªõc</strong>. √ù t∆∞·ªüng c·ªßa RNN ch√≠nh l√† nh∆∞ v·∫≠y.</p>
<p>S∆° l∆∞·ª£c v·ªÅ c√°ch ho·∫°t ƒë·ªông c·ªßa RNN ƒë∆∞·ª£c m√¥ t·∫£ nh∆∞ sau:</p>
<ul>
<li>V·ªõi ƒëi·ªÅu ki·ªán gi·∫£ s·ª≠ $T_x=T_y$, ta s·∫Ω th·ª±c hi·ªán t√≠nh to√°n $T_x$ l·∫ßn, t·∫°i th·ªùi ƒëi·ªÉm (hay l√† v·ªã tr√≠) th·ª© $i$ th√¨ t·ª´ $x^{&lt; i &gt;}$ (input) ta t√≠nh ra $y^{&lt; i &gt;}$ (output).</li>
<li>H∆°n n·ªØa, ƒë·ªÉ th·ª±c hi·ªán thao t√°c <strong>l∆∞u gi·ªØ c√°c th√¥ng tin cho ƒë·∫øn th·ªùi ƒëi·ªÉm hi·ªán t·∫°i</strong> v√† ƒë∆∞a n√≥ qua c√°c th·ªùi ƒëi·ªÉm sau, ta c≈©ng c·∫ßn t√≠nh th√™m m·ªôt gi√° tr·ªã l√†  $h^{&lt; i &gt;}$ (gi·∫£ s·ª≠ lu√¥n $h^{&lt;0&gt;} = 0$). L√∫c n√†y, ta g·ªçi $h^{&lt; i &gt;}$ l√† <strong>tr·∫°ng th√°i ·∫©n</strong> (hidden state)</li>
<li>Nh∆∞ v·∫≠y, t·∫°i m·ªói th·ªùi ƒëi·ªÉm th√¨ ta c·∫ßn t√≠nh ra $h^{&lt; i &gt;}$ v√† $y^{&lt; i &gt;}$, d·ª±a v√†o 2 input l√† $x^{&lt; i &gt;}$ v√† th√¥ng tin t·ª´ nh·ªØng th·ªùi ƒëi·ªÉm tr∆∞·ªõc ƒë∆∞·ª£c t·ªïng h·ª£p t·∫°i $h^{&lt;i - 1&gt;}$.</li>
</ul>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 200px;" src='./images/rnn-1.png'>
<p align="center" style="margin: 0; color: #888;"> Minh h·ªça ban ƒë·∫ßu cho RNN<br>
Ngu·ªìn: <a href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning">deeplearning.ai</a>
</p>
</div>
<p>Nh√¨n v√†o h√¨nh tr√™n, ta c√≥ th·ªÉ suy ra r·∫±ng nh·ªØng tr·ªçng s·ªë m√† RNN c·∫ßn h·ªçc l√† ma tr·∫≠n tr·ªçng s·ªë c·ªßa hidden layer ·ªü c√°c th·ªùi ƒëi·ªÉm. ƒê·ªÉ thu·∫≠n ti·ªán cho c√°c ph·∫ßn sau, ta s·∫Ω quy ∆∞·ªõc k√≠ hi·ªáu nh∆∞ sau:</p>
<ul>
<li>Vector input, output v√† hidden state t·∫°i th·ªùi ƒëi·ªÉm $t$ l·∫ßn l∆∞·ª£t l√† $\bold{X}_t \in \mathbb{R}^d$, $\bold{O}_t  \in \mathbb{R}^o$ v√† $\bold{H}_t \in \mathbb{R}^h$.</li>
<li>Ma tr·∫≠n tr·ªçng s·ªë cho ph√©p t√≠nh li√™n quan gi·ªØa $\bold{X}_t$ v√† $\bold{H}_t$ l√† $\bold{W}^{t}_{ xh } \in \mathbb{R}^{ h \times d }$.</li>
<li>T∆∞∆°ng t·ª± nh∆∞ tr√™n, ta c√≥ $\bold{W}^{t}_{hh}  \in \mathbb{R}^{h \times h}$ v√† $\bold{W}^{t}_{ho}  \in \mathbb{R}^{o \times h}$.</li>
</ul>
<p>Khi ƒë√≥, ta c√≥ th·ªÉ bi·ªÉu di·ªÖn RNN nh∆∞ sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 230px;" src='./images/rnn-2.png'>
<p align="center" style="margin: 0; color: #888;"> Ngu·ªìn: <a href="https://d2l.ai/_images/rnn.svg">Dive into DL</a>
</p>
</div>
<h3 id="s·ª±-chia-s·∫ª-tr·ªçng-s·ªë-gi·ªØa-c√°c-th·ªùi-ƒëi·ªÉm">S·ª± chia s·∫ª tr·ªçng s·ªë gi·ªØa c√°c th·ªùi ƒëi·ªÉm</h3>
<p>Qua m√¥ t·∫£ v·ªÅ c√°ch ho·∫°t ƒë·ªông c·ªßa RNN ·ªü ph·∫ßn tr∆∞·ªõc, ta th·∫•y r·∫±ng n·∫øu ·ªü m·ªói th·ªùi ƒëi·ªÉm m√† ta c·∫ßn d√πng m·ªôt b·ªô tr·ªçng s·ªë kh√°c nhau th√¨ l∆∞·ª£ng tham s·ªë c·ªßa m√¥ h√¨nh RNN s·∫Ω l·ªõn kh√¥ng k√©m g√¨ MLP ·ªü ph·∫ßn <strong>3.1</strong> üòÄ</p>
<p>Trong RNN, gi·ªØa c√°c th·ªùi ƒëi·ªÉm s·∫Ω c√≥ s·ª± <strong>chia s·∫ª tr·ªçng s·ªë</strong>, t·ª©c l√† m·ªçi th·ªùi ƒëi·ªÉm ƒë·ªÅu d√πng c√πng m·ªôt b·ªô tr·ªçng s·ªë $(\bold{W}_{xh}, \bold{W}_{hh}, \bold{W}_{ho})$ ƒë·ªÉ t√≠nh to√°n $\bold{O}_t$ v√† $\bold{H}_t$. L·ª£i √≠ch c·ªßa vi·ªác chia s·∫ª tr·ªçng s·ªë bao g·ªìm:</p>
<ul>
<li>S·ªë l∆∞·ª£ng tr·ªçng s·ªë trong RNN s·∫Ω gi·∫£m ƒëi r·∫•t nhi·ªÅu l·∫ßn so v·ªõi MLP</li>
<li>Ta c≈©ng c√≥ th·ªÉ kh·∫Øc ph·ª•c ƒë∆∞·ª£c nh∆∞·ª£c ƒëi·ªÉm c·ªßa MLP trong vi·ªác ‚Äúchia s·∫ª ƒë·∫∑c tr∆∞ng‚Äù gi·ªØa c√°c v·ªã tr√≠ kh√°c nhau trong c√¢u.</li>
</ul>
<p>Khi ƒë√≥, t·ª´ h√¨nh ·ªü ph·∫ßn <strong>3.2</strong>, sau khi ch√∫ th√≠ch v·ªã tr√≠ c√°c ma tr·∫≠n tr·ªçng s·ªë ƒë∆∞·ª£c s·ª≠ d·ª•ng th√¨ ta c√≥ h√¨nh sau:</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 230px;" src='./images/rnn-3.png'>
</p>
<p>Thay v√¨ ph·∫£i bi·ªÉu di·ªÖn ƒë·ªß c√°c th·ªùi ƒëi·ªÉm, ta c√≥ th·ªÉ vi·∫øt g·ªçn l·∫°i RNN nh∆∞ h√¨nh b√™n d∆∞·ªõi:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px;" src='./images/rnn-4.png'>
<p align="center" style="margin: 0; color: #888;"> Bi·ªÉu di·ªÖn g·ªçn h∆°n c·ªßa Recurrent Neural Network
</p>
</div>
<h3 id="qu√°-tr√¨nh-feed-forward">Qu√° tr√¨nh feed-forward</h3>
<p>ƒê·∫ßu ti√™n, ta s·∫Ω xem hidden state ban ƒë·∫ßu l√† $\bold{H}_0 = \bold{0}$. ƒê·ªÉ ƒë∆°n gi·∫£n, ta s·∫Ω b·ªè qua c√°c gi√° tr·ªã bias ·ª©ng v·ªõi $\bold{H}_t$ v√† $\bold{O}_t$. Khi ƒë√≥, qu√° tr√¨nh feed-forward t·∫°i th·ªùi ƒëi·ªÉm $t &gt; 0$ di·ªÖn ra nh∆∞ sau:</p>
<p>$$\begin{equation}
\bold{H}_t = \phi_h (\bold{W}_{xh} \bold{X}_t + \bold{W}_{hh} \bold{H}_{t-1})
\end{equation}$$
$$\begin{equation}
\bold{O}_t = \phi_o (\bold{W}_{ho} \bold{H}_t)
\end{equation}$$</p>
<p>, v·ªõi $\phi_h$ v√† $\phi_o$ l√† c√°c activation function. Th√¥ng th∆∞·ªùng, $\phi_h$ l√† $ReLU$  ho·∫∑c $\tanh$ v√† $\phi_o$ th∆∞·ªùng l√† $\text{softmax}$.</p>
<p>Nh∆∞ v·∫≠y, t·ª´ $\bold{X}_{t}$ v√† $\bold{H}_{t-1}$ ta s·∫Ω t√≠nh ƒë∆∞·ª£c $\bold{H}_{t}$, v√† t·ª´ $\bold{H}_{t}$ th√¨ ta s·∫Ω t√≠nh ƒë∆∞·ª£c $\bold{O}_{t}$.</p>
<p><strong>Nh·∫≠n x√©t.</strong></p>
<ul>
<li>
<p>Ta c√≥ th·ªÉ nh·∫≠n th·∫•y r·∫•t r√µ s·ª± kh√°c bi·ªát gi·ªØa feed-forward trong RNN so v·ªõi MLP. V·ªõi MLP th√¨ n√≥ ch·ªâ c·∫ßn hai ph√©p to√°n (xem nh∆∞ ph·∫ßn hidden layers ch·ªâ c√≥ 1 layer) l√† c√≥ lu√¥n k·∫øt qu·∫£ cu·ªëi c√πng:</p>
<p>$$\begin{equation*}
\bold{H} = \phi_h (\bold{X} \bold{W}_{xh}^\top  )
\end{equation*}$$
$$\begin{equation*}
\bold{O} = \phi_o (\bold{H} \bold{W}^\top _{ho} )
\end{equation*}$$</p>
<p>, v·ªõi $\bold{X} \in \mathbb{R}^{n \times d}$ v√† $\bold{H}  \in \mathbb{R}^{n \times h}$ l√† c√°c ma tr·∫≠n ·ª©ng v·ªõi to√†n b·ªô gi√° tr·ªã input v√† hidden state (trong RNN th√¨ $\bold{X}_t$ v√† $\bold{H}_t$ l√† c√°c vector).</p>
</li>
</ul>
<h3 id="back-propagation-through-time-bptt">Back-propagation Through Time (BPTT)</h3>
<p>Khi m√† feed-forward trong RNN di·ªÖn ra kh√°c v·ªõi MLP th√¨ t·∫•t nhi√™n l√† back-propagation c≈©ng kh√°c üòÄ Thu·∫≠t to√°n back-propagation trong sequence model ƒë∆∞·ª£c g·ªçi l√† <strong>Back-propagation Through Time</strong> (BPTT).</p>
<p>ƒê·∫ßu ti√™n, ta s·∫Ω ƒë·ªÅ c·∫≠p ƒë·∫øn cost <strong>function</strong>. Gi·∫£ s·ª≠ output c·ªßa RNN l√† $\bold{O}$ v√† label l√† $\bold{Y}$. K√≠ hi·ªáu $l(\bold{O}_t, \bold{Y}_t)$ l√† loss t·∫°i th·ªùi ƒëi·ªÉm $t$. Khi ƒë√≥ cost function c·ªßa ta l√†</p>
<p>$$\begin{equation}
L= \sum_{i=1}^{T} l(\bold{O}_t, \bold{Y}_t)
\end{equation}$$</p>
<ul>
<li>Th·ª±c ra l√† ta c√≥ chia $L$ cho $T$ n·ªØa nh∆∞ng ƒë·ªÉ cho g·ªçn th√¨ th√¥i b·ªè qua üòú</li>
</ul>
<p>Nh·ªØng g√¨ ta c·∫ßn th·ª±c hi·ªán trong qu√° tr√¨nh BPTT l√† t√≠nh ƒë·∫°o h√†m c·ªßa $L$ theo c√°c ma tr·∫≠n tr·ªçng s·ªë $\bold{W}_{xh}$, $\bold{W}_{hh}$ v√† $\bold{W}_{ho}$. ƒêi·ªÅu ƒë·∫∑c bi·ªát ·ªü ƒë√¢y l√† trong qu√° tr√¨nh feed-forward th√¨ $\bold{H}_{t-1}$ s·∫Ω l·∫°i ƒë∆∞·ª£c d√πng ƒë·ªÉ t√≠nh $\bold{H}_t$ ch·ª© n√≥ kh√¥ng ƒëi m·ªôt ‚Äúm·∫°ch&quot; t·ª´ $\bold{X}$ ƒë·∫øn $\bold{H}$ r·ªìi t·ª´ $\bold{H}$ ƒë·∫øn $\bold{O}$ nh∆∞ trong feed-forward c·ªßa MLP th√¥ng th∆∞·ªùng.</p>
<p>ƒê·ªÉ c√¥ng th·ª©c ƒë∆∞·ª£c g·ªçn nh·∫π h∆°n, ta s·∫Ω gi·∫£ s·ª≠ lu√¥n c√°c activation function $\phi_h$ v√† $\phi_o$ l√† h√†m ƒë·ªìng nh·∫•t, t·ª©c l√†</p>
<p>$$\phi_h(\bold{x}) = \phi_o(\bold{x}) = \bold{x}$$</p>
<p><strong>Qu√° tr√¨nh BPPT di·ªÖn ra nh∆∞ sau:</strong></p>
<ul>
<li>
<p>ƒê·∫ßu ti√™n, d·ªÖ nh·∫•t l√† t√≠nh ƒë·∫°o h√†m $L$ theo $\bold{W}_{ho}$ üòÄ T·ª´ ph∆∞∆°ng tr√¨nh $(3)$ th√¨ ta c√≥ ngay</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{O}_{t}} = \frac{\partial l(\bold{O}_t, \bold{Y}_t)}{\partial \bold{O}_{t}}
\end{equation}$$</p>
<p>Do ƒë√≥, k·∫øt h·ª£p $(2)$ v√† $(4)$ th√¨</p>
<p>$$
\frac{\partial L}{\partial \bold{W}_{ho}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{O}_{t}} \frac{\partial \bold{O}_t}{\partial \bold{W}_{ho}}  \right ) = \sum_{t=1}^{T} \left (  \frac{\partial L}{\partial \bold{O}_{t}}\bold{H}_t^\top \right )
$$</p>
<p><strong>L∆∞u √Ω.</strong> C√°ch t√≠nh gi√° tr·ªã c·ªßa $\dfrac{\partial l(\bold{O}_t, \bold{Y}_t)}{\partial \bold{O}_{t}}$ trong ph∆∞∆°ng tr√¨nh $(4)$ s·∫Ω ph·ª• thu·ªôc v√†o h√†m $l$ v√† th∆∞·ªùng th√¨ n√≥ r·∫•t d·ªÖ t√≠nh üòú</p>
</li>
<li>
<p>Ti·∫øp theo, ta c√≥ nh·∫≠n x√©t sau:</p>
<ul>
<li>$\bold{H}_T$ ch·ªâ tham gia v√†o m·ªôt bi·ªÉu th·ª©c trong qu√° tr√¨nh feed-forward (ƒë·ªÉ t√≠nh ra $\bold{O}_T$)</li>
<li>$\bold{H}_{t}$ v·ªõi $t &lt; T$ th√¨ tham gia v√†o hai bi·ªÉu th·ª©c (t√≠nh $\bold{H}_{t +1}$ v√† $\bold{O}_t$)</li>
</ul>
<p>Do ƒë√≥, c√°ch t√≠nh $\dfrac{\partial L}{\partial \bold{H}_{t}}$ s·∫Ω c√≥ s·ª± kh√°c bi·ªát t√πy theo gi√° tr·ªã $t$.</p>
<ul>
<li>
<p>V·ªõi $t = T$: T·ª´ $(2)$ v√† $(4)$ ta c√≥</p>
<p>$$
\frac{\partial L}{\partial \bold{H}_{T}} = \frac{\partial L}{\partial \bold{O}_{T}} \frac{\partial \bold{O}_T}{\partial \bold{H}_{T}} = \bold{W}_{ho}^\top \frac{\partial L}{\partial \bold{O}_{T}}
$$</p>
</li>
<li>
<p>V·ªõi $t &lt; T$: T·ª´ $(1), (2)$ v√† $(4)$ th√¨</p>
<p>$$
\frac{\partial L}{\partial \bold{H}_{t}} = \frac{\partial L}{\partial \bold{O}_{t}} \frac{\partial \bold{O}_t}{\partial \bold{H}_{t}} + \frac{\partial L}{\partial \bold{H}_{t+1}} \frac{\partial \bold{H}_{t+1}}{\partial \bold{H}_{t}} = \bold{W}_{ho}^\top \frac{\partial L}{\partial \bold{O}_{t}}  + \bold{W}_{hh}^\top \frac{\partial L}{\partial \bold{H}_{t+1}}
$$</p>
<p>C·ª© ti·∫øp t·ª•c bi·∫øn ƒë·ªïi ti·∫øp v·ªõi $\dfrac{\partial L}{\partial \bold{H}_{t+1}}$ v√† c·ª© nh∆∞ th·∫ø cho ƒë·∫øn $T$, ta s·∫Ω c√≥</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \mathbf{H}_t}= \sum_{i=t}^T {\left(\mathbf{W}_{hh}^\top\right)}^{T-i} \mathbf{W}_{ho}^\top \frac{\partial L}{\partial \mathbf{O}_{T+t-i}}
\end{equation}$$</p>
<p>, v√† ƒë·ªÉ √Ω r·∫±ng bi·ªÉu th·ª©c $(5)$ c≈©ng ƒë√∫ng v·ªõi $t = T$.</p>
</li>
</ul>
<p>V·∫≠y t·ª´ $(1)$ v√† $(5)$ th√¨</p>
</li>
</ul>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{W}_{xh}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \frac{\partial \bold{H}_t}{\partial \bold{W}_{xh}} \right ) =  = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \bold{X}_t^\top \right )
\end{equation}$$</p>
<p>$$\begin{equation}
\frac{\partial L}{\partial \bold{W}_{hh}} = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \frac{\partial \bold{H}_t}{\partial \bold{W}_{hh}} \right ) =  = \sum_{t=1}^{T} \left ( \frac{\partial L}{\partial \bold{H}_{t}} \bold{H}_{t-1}^\top \right )
\end{equation}$$</p>
<h3 id="v·∫•n-ƒë·ªÅ-vanishing-v√†-exploding-gradients-trong-rnn">V·∫•n ƒë·ªÅ vanishing v√† exploding gradients trong RNN</h3>
<p>Qua c√°c bi·ªÉu th·ª©c $(6)$ v√† $(7)$, ta th·∫•y r·∫±ng n·∫øu gi√° tr·ªã $T$ l·ªõn (t·ª©c l√† c√¢u input g·ªìm r·∫•t nhi·ªÅu t·ª´) th√¨ s·∫Ω c√≥ hai tr∆∞·ªùng h·ª£p x·∫£y ra ƒë·ªëi v·ªõi c√°c gi√° tr·ªã gradient $\dfrac{\partial L}{\partial \bold{W}_{xh}}$ v√† $\dfrac{\partial L}{\partial \bold{W}_{ho}}$:</p>
<ul>
<li><strong>Vanishing:</strong> Trong qu√° tr√¨nh t√≠nh $\bold{W}_{hh}^\top$ c√≥ nhi·ªÅu gi√° tr·ªã nh·ªè h∆°n 1 ƒë∆∞·ª£c nh√¢n v·ªõi nhau.</li>
<li><strong>Exploding:</strong> Ng∆∞·ª£c l·∫°i (l·ªõn h∆°n 1).</li>
</ul>
<p>Ta c√≥ m·ªôt gi·∫£i ph√°p ƒë·ªÉ h·∫°n ch·∫ø hi·ªán t∆∞·ª£ng n√†y l√† <strong>Truncated BPTT</strong>, t·ª©c l√† ta ch·ªâ lan truy·ªÅn gradients ƒë·∫øn m·ªôt tr·∫°ng th√°i c√°ch tr·∫°ng th√°i hi·ªán t·∫°i m·ªôt kho·∫£ng n√†o ƒë√≥ th√¥i ch·ª© kh√¥ng lan truy·ªÅn to√†n b·ªô.</p>
<p>ƒê·ªëi v·ªõi hi·ªán t∆∞·ª£ng vanishing trong RNN, ta c√≥ th·ªÉ di·ªÖn ƒë·∫°t n√≥ m·ªôt c√°ch vƒÉn v·ªü h∆°n l√† m√¥ h√¨nh ƒë√£ b·ªã ‚Äúqu√™n‚Äù nh·ªØng th√¥ng tin t√≠ch l≈©y t·ª´ ph√≠a tr∆∞·ªõc.</p>
<ul>
<li>
<p>V√≠ d·ª•, ta c√≥ hai c√¢u sau:</p>
<ol>
<li>The <strong>cat</strong>, which always ‚Ä¶ (very long descriptions) ‚Ä¶, <strong>was</strong> very cute</li>
<li>The <strong>cats</strong>, which always ‚Ä¶ (very long descriptions) ‚Ä¶, <strong>were</strong> very cute</li>
</ol>
<p>Th√¥ng th∆∞·ªùng, ƒë·ªông t·ª´ to-be ·ªü tr∆∞·ªõc ‚Äúvery cute‚Äù s·∫Ω ph·ª• thu·ªôc v√†o danh t·ª´ ·ªü ƒë·∫ßu c√¢u (‚Äùcat‚Äù hay ‚Äúcats‚Äù). Tuy nhi√™n, n·∫øu RNN b·ªã vanishing gradient th√¨ n√≥ s·∫Ω kh√¥ng th·ªÉ nh·ªõ ƒë∆∞·ª£c tr∆∞·ªõc ƒë√≥ l√† m·ªôt con m√®o hay nhi·ªÅu con m√®o ƒë·ªÉ m√† ch·ªçn ƒë·ªông t·ª´ to-be cho ƒë√∫ng. üòÄ</p>
</li>
</ul>
<p>Y·∫øu t·ªë n√†y ƒë√£ m·ªü ra m·ªôt h∆∞·ªõng ph√°t tri·ªÉn cho RNN l√† ta s·∫Ω c·ªë g·∫Øng t√≠nh to√°n th√™m nh·ªØng ph√©p to√°n kh√°c ƒë·ªÉ duy tr√¨ ƒë∆∞·ª£c c√°c th√¥ng tin t·ª´ tr∆∞·ªõc, t·ª´ ph√≠a xa m√† RNN hi·ªán t·∫°i kh√¥ng th·ªÉ ghi nh·ªõ ƒë∆∞·ª£c. T·ª´ ƒë√≥, ta c√≥ s·ª± ra ƒë·ªùi c·ªßa <strong>Gated Recurrent Unit (GRU)</strong> v√† <strong>Long Short-Term Memory (LSTM)</strong>.</p>
<h2 id="c√°c-d·∫°ng-m√¥-h√¨nh-rnn">C√°c d·∫°ng m√¥ h√¨nh RNN</h2>
<p>Ch√∫ng ta ƒë·ªÉ √Ω r·∫±ng d·∫°ng m√¥ h√¨nh RNN m√¨nh ƒë√£ tr√¨nh b√†y ·ªü ph·∫ßn tr∆∞·ªõc ƒëang nh·∫≠n input l√† m·ªôt c√¢u v√† output c·ªßa n√≥ c≈©ng l√† m·ªôt c√¢u. D·∫°ng m√¥ h√¨nh n√†y c√≤n g·ªçi l√† <strong>many-to-many.</strong> T√πy v√†o b√†i to√°n c·∫ßn gi·∫£i quy·∫øt m√† ta c√≥ c√°c d·∫°ng nh∆∞ sau:</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 350px;" src='./images/rnn-types.png'>
<p align="center" style="margin: 0; color: #888;"> C√°c d·∫°ng c·ªßa m√¥ h√¨nh RNN<br>
Ngu·ªìn: <a href="https://static.javatpoint.com/tutorial/tensorflow/images/tensorflow-types-of-rnn.png](https://static.javatpoint.com/tutorial/tensorflow/images/tensorflow-types-of-rnn.png">Javatpoint</a>
</p>
</div>
<ul>
<li><strong>One-to-one:</strong> C√°i n√†y th√¨ r·∫•t th∆∞·ªùng th·∫•y, v√≠ d·ª• nh∆∞ Image Classification.</li>
<li><strong>One-to-many:</strong> C√≥ th·ªÉ l·∫•y v√≠ d·ª• nh∆∞ b√†i to√°n sinh ra vƒÉn b·∫£n ho·∫∑c √¢m nh·∫°c. Ta cung c·∫•p input l√† m·ªôt t·ª´ b·∫•t k√¨ v√† m√¥ h√¨nh s·∫Ω t·∫°o ra t·ª´ k·∫ø ti·∫øp, ta l·∫°i ƒëem t·ª´ n√†y v√†o l√†m input ƒë·ªÉ c√≥ t·ª´ ti·∫øp theo.</li>
<li><strong>Many-to-one:</strong> B√†i to√°n Sentiment Anylysis, Mail fitlering,‚Ä¶</li>
<li><strong>Many-to-many:</strong> Ch·ªß y·∫øu l√† b√†i to√°n Machine Translation.</li>
</ul>
<h2 id="t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</h2>
<ul>
<li><a class="link" href="https://arxiv.org/abs/1912.05911"  target="_blank" rel="noopener"
    >Robin M. Schmidtm, Recurrent Neural Networks (RNNs): A gentle Introduction and Overview</a></li>
<li><a class="link" href="https://d2l.ai/chapter_recurrent-neural-networks/rnn.html"  target="_blank" rel="noopener"
    >Dive into DL, Recurrent Neural Network</a></li>
<li><a class="link" href="https://www.coursera.org/learn/nlp-sequence-models?specialization=deep-learning"  target="_blank" rel="noopener"
    >DeepLearning.AI, Deep Learning Specialization, 5. Sequence Models</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/rnn/">rnn</a>
        
            <a href="/tags/sequence-data/">sequence-data</a>
        
            <a href="/tags/sequence-models/">sequence-models</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/efficientnet/">
        
        

        <div class="article-details">
            <h2 class="article-title">EfficientNet (2020)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet_v2/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet V2 (2019)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/densenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">DenseNet (2018)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/cam/">
        
        

        <div class="article-details">
            <h2 class="article-title">CAM, Grad-CAM v√† Score-CAM trong CNN</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet (2017)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

<div id="disqus_thread"></div>

<p><b>L∆∞u √Ω.</b> N·∫øu ph·∫ßn Comment kh√¥ng load ra ƒë∆∞·ª£c th√¨ c√°c b·∫°n v√†o DNS setting c·ªßa Wifi/LAN v√† ƒë·ªïi th√†nh "8.8.8.8" nh√© (server c·ªßa Google)!</p>


<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://htrvu-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 Hoang Trong Vu
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
