<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Gi·ªõi thi·ªáu ph∆∞∆°ng ph√°p Compoud Scaling, √Ω t∆∞·ªüng v√† ki·∫øn tr√∫c c·ªßa h·ªç m√¥ h√¨nh EfficientNet'>
<title>EfficientNet (2020)</title>

<link rel='canonical' href='https://htrvu.github.io/post/efficientnet/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='EfficientNet (2020)'>
<meta property='og:description' content='Gi·ªõi thi·ªáu ph∆∞∆°ng ph√°p Compoud Scaling, √Ω t∆∞·ªüng v√† ki·∫øn tr√∫c c·ªßa h·ªç m√¥ h√¨nh EfficientNet'>
<meta property='og:url' content='https://htrvu.github.io/post/efficientnet/'>
<meta property='og:site_name' content='Hoang Trong Vu'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='cnn' /><meta property='article:tag' content='efficientnet' /><meta property='article:tag' content='compound scaling' /><meta property='article:tag' content='grid search' /><meta property='article:published_time' content='2023-02-15T11:17:46&#43;07:00'/><meta property='article:modified_time' content='2023-02-15T11:17:46&#43;07:00'/>
<meta name="twitter:title" content="EfficientNet (2020)">
<meta name="twitter:description" content="Gi·ªõi thi·ªáu ph∆∞∆°ng ph√°p Compoud Scaling, √Ω t∆∞·ªüng v√† ki·∫øn tr√∫c c·ªßa h·ªç m√¥ h√¨nh EfficientNet">
    <link rel="shortcut icon" href="/neural.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu4ef57fa6d8ae56d86d9663ef18f7ace5_124758_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Hoang Trong Vu</a></h1>
            <h2 class="site-description">Keep going!</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/htrvu'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/htrvu/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"/> <rect x="4" y="4" width="16" height="16" rx="2" /> <line x1="8" y1="11" x2="8" y2="16" /> <line x1="8" y1="8" x2="8" y2="8.01" /> <line x1="12" y1="16" x2="12" y2="11" /> <path d="M16 16v-3a2 2 0 0 0 -4 0" /> </svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#gi·ªõi-thi·ªáu">Gi·ªõi thi·ªáu</a></li>
    <li><a href="#b√†i-to√°n-model-scaling">B√†i to√°n model scaling</a></li>
    <li><a href="#ph∆∞∆°ng-ph√°p-compound-scaling">Ph∆∞∆°ng ph√°p compound scaling</a></li>
    <li><a href="#h·ªç-m√¥-h√¨nh-efficientnet">H·ªç m√¥ h√¨nh EfficientNet</a>
      <ol>
        <li><a href="#neural-architecture-search">Neural architecture search</a></li>
        <li><a href="#ki·∫øn-tr√∫c-m√¥-h√¨nh">Ki·∫øn tr√∫c m√¥ h√¨nh</a></li>
      </ol>
    </li>
    <li><a href="#t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/cv/" style="background-color: #2a9d8f; color: #fff;">
                Computer Vision
            </a>
        
            <a href="/categories/dl/" style="background-color: #2a9d8f; color: #fff;">
                Deep Learning
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/efficientnet/">EfficientNet (2020)</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Gi·ªõi thi·ªáu ph∆∞∆°ng ph√°p Compoud Scaling, √Ω t∆∞·ªüng v√† ki·∫øn tr√∫c c·ªßa h·ªç m√¥ h√¨nh EfficientNet
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 15, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="gi·ªõi-thi·ªáu">Gi·ªõi thi·ªáu</h2>
<p>Ta bi·∫øt r·∫±ng, h·∫ßu h·∫øt c√°c m√¥ h√¨nh CNN th∆∞·ªùng ƒë∆∞·ª£c x√¢y d·ª±ng t·ª´ m·ªôt phi√™n b·∫£n ban ƒë·∫ßu (c√≥ th·ªÉ l√† d·ª±a theo m·ªôt ngu·ªìn t√†i nguy√™n n√†o ƒë√≥), sau ƒë√≥ ch√∫ng ƒë∆∞·ª£c scale d·∫ßn l√™n ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c ƒë·ªô ch√≠nh x√°c t·ªët h∆°n, v√† t·∫•t nhi√™n l√† ƒë·ªô ph·ª©c t·∫°p c≈©ng tƒÉng theo</p>
<ul>
<li>V√≠ d·ª•: V·ªõi ResNet th√¨ ta c√≥ ResNet18 cho ƒë·∫øn ResNet152, DenseNet th√¨ DenseNet121 cho ƒë·∫øn 201, MobileNet th√¨ ta c√≥ si√™u tham s·ªë width multiplier ƒë·ªÉ ƒëi·ªÅu ch·ªânh s·ªë channel trong t·ª´ng layer v√† resolutiom multiplier ƒë·ªÉ ƒëi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc t·∫°i c√°c layer,‚Ä¶</li>
</ul>
<p>Nh·ªØng c√°ch l√†m ƒë√≥ g·ªçi l√† <strong>model scaling</strong>. Tuy nhi√™n, ta nh·∫≠n th·∫•y r·∫±ng nh·ªØng thao t√°c model scaling tr∆∞·ªõc ƒë√≥ ch·ªâ t·∫≠p trung v√†o m·ªôt trong 3 y·∫øu t·ªë: <strong>depth - $d$</strong> (s·ªë layer), <strong>width - $w$</strong> (s·ªë channel) v√† <strong>resolution - $r$</strong>. H∆°n n·ªØa, vi·ªác ƒëi·ªÅu ch·ªânh c≈©ng <strong>kh√¥ng theo m·ªôt nguy√™n t·∫Øc n√†o</strong> m√† c√≤n mang ƒë·∫≠m t√≠nh ch·∫•t ng·∫´u nhi√™n, ‚Äúh√™n xui‚Äù, c·∫ßn ph·∫£i th·ª≠ nghi·ªám r·∫•t nhi·ªÅu l·∫ßn m·ªõi c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ªôt ƒë·ªô ch√≠nh x√°c mong mu·ªën. Khi ƒë√≥ th√¨ s·ªë l∆∞·ª£ng tham s·ªë c·ªßa c√°c m√¥ h√¨nh c≈©ng tƒÉng ch√≥ng m·∫∑t!</p>
<p>C√°c t√°c gi·∫£ c·ªßa paper ƒë√£ cho th·∫•y k·∫øt qu·∫£ th·ª±c nghi·ªám r·∫±ng vi·ªác ƒëi·ªÅu ch·ªânh m·ªôt trong 3 y·∫øu t·ªë c√≥ th·ªÉ tƒÉng ƒë·ªô ch√≠nh x√°c nh∆∞ng ch·ªâ tƒÉng ƒë·∫øn m·ªôt m·ª©c n√†o ƒë√≥ th√¥i, sau ƒë√≥ n√≥ s·∫Ω b·ªã b√£o h√≤a. V√≠ d·ª• nh∆∞ ·ªü h√¨nh b√™n d∆∞·ªõi:</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px" src='./images/compare.png'>
</p>
<p>Ta c√≥ th·ªÉ ƒë∆∞a ra c√°c nh·∫≠n x√©t nh∆∞ sau:</p>
<ul>
<li>N·∫øu m√¥ h√¨nh c√≥ width l·ªõn (m·ªói layer c√≥ nhi·ªÅu channel) th√¨ n√≥ c√≥ th·ªÉ h·ªçc ƒë∆∞·ª£c nhi·ªÅu lo·∫°i ƒë·∫∑c tr∆∞ng kh√°c nhau. Nh∆∞ng n·∫øu m√¥ h√¨nh kh√¥ng ƒë·ªß s√¢u th√¨ c√°c ƒë·∫∑c tr∆∞ng ƒë√≥ c≈©ng ch∆∞a ph·∫£i ƒë·∫∑c tr∆∞ng ·ªü m·ª©c high-level (n·ªïi b·∫≠t cho ƒë·ªëi t∆∞·ª£ng)</li>
<li>N·∫øu m√¥ h√¨nh c√≥ depth l·ªõn th√¨ n√≥ c√≥ th·ªÉ h·ªçc ƒë∆∞·ª£c c√°c ƒë·∫∑c tr∆∞ng high-level nh∆∞ng n·∫øu kh√¥ng c√≥ width l·ªõn th√¨ c≈©ng kh√¥ng h·ªçc ƒë∆∞·ª£c nhi·ªÅu lo·∫°i ƒë·∫∑c tr∆∞ng*</li>
<li>V·ªÅ m·∫∑t tr·ª±c gi√°c, n·∫øu ta ƒë∆∞a v√†o m√¥ h√¨nh m·ªôt b·ª©c ·∫£nh c√≥ resolution cao th√¨ m√¥ h√¨nh n√™n c√≥ depth l·ªõn ƒë·ªÉ c√≥ th·ªÉ d·∫ßn h·ªçc c√°c ƒë·∫∑c tr∆∞ng t·ª´ c√°c feature maps c√≥ resolution l·ªõn, ƒë·ªìng th·ªùi c≈©ng v√¨ s·∫Ω c√≥ nhi·ªÅu ƒë·∫∑c tr∆∞ng h∆°n n√™n ta c·∫ßn width l·ªõn. Do ƒë√≥, model scaling n√™n t·∫≠p trung v√†o vi·ªác ƒëi·ªÅu ch·ªânh ƒë·ªìng th·ªùi c·∫£ 3 y·∫øu t·ªë $d$, $w$, $r$.</li>
</ul>
<p>Paper c√¥ng b·ªë EfficientNet c√≥ t√™n l√† ‚ÄúEfficientNet: <strong>Rethinking Model Scaling</strong> for Convolutional Neural Networks‚Äù. C√°c t√°c gi·∫£ t·∫≠p trung v√†o vi·ªác ƒëi t√¨m m·ªôt ph∆∞∆°ng ph√°p model scaling hi·ªáu qu·∫£, <strong>c√≥ nguy√™n t·∫Øc</strong>, ƒëi·ªÅu ch·ªânh ƒë·ªìng th·ªùi c·∫£ 3 y·∫øu t·ªë nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p. Ph∆∞∆°ng ph√°p ƒë∆∞·ª£c gi·ªõi thi·ªáu c√≥ t√™n l√† <strong>compound scaling.</strong></p>
<p>&ldquo;Nguy√™n t·∫Øc&rdquo; trong ph∆∞∆°ng ph√°p n√†y r·∫•t ƒë∆°n gi·∫£n, ta s·∫Ω c√πng ƒëi·ªÅu ch·ªânh $d$, $w$, $r$ c·ªßa to√†n b·ªô network <strong>theo</strong> <strong>c√πng m·ªôt h·ªá s·ªë</strong> g·ªçi l√† <strong>compound coefficient</strong> (k√≠ hi·ªáu l√† $\phi$).</p>
<div style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 300px" src='./images/illustrate.png'>
<p align="center" style="margin: 0; color: #888;">
Minh h·ªça cho c√°c ph∆∞∆°ng ph√°p model scaling. (a) l√† m√¥ h√¨nh ban ƒë·∫ßu. (b)-(d) th·ª±c hi·ªán ƒëi·ªÅu ch·ªânh m·ªôt trong ba y·∫øu t·ªë. (e) l√† ph∆∞∆°ng ph√°p ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t, n√≥ ti·∫øn h√†nh ƒëi·ªÅu ch·ªânh c·∫£ ba.
</p>
</div>
<p>T·∫•t nhi√™n l√† model scaling ch·ªâ ph√°t huy t√°c d·ª•ng khi m√† m√¥ h√¨nh ban ƒë·∫ßu l√† ƒë·ªß t·ªët. T·ª´ ph∆∞∆°ng ph√°p compound scaling, c√°c t√°c gi·∫£ ƒë√£ √°p d·ª•ng n√≥ cho ResNet, MobileNet ƒë·ªÉ ch·ª©ng t·ªè ƒë·ªô hi·ªáu qu·∫£ c·ªßa ph∆∞∆°ng ph√°p. Sau ƒë√≥, m·ªôt h·ªç m√¥ h√¨nh m·ªõi ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t l√† EfficientNet, v·ªõ 8 phi√™n b·∫£n t·ª´ B0 ƒë·∫øn B7 v·ªõi ƒë·ªô ph·ª©c t·∫°p v√† ƒë·ªô ch√≠nh x√°c tƒÉng d·∫ßn tr√™n t·∫≠p ImageNet. EfficientNet-B7 ƒë√£ tr·ªü th√†nh SOTA (state-of-the-art) v·ªõi ƒë·ªô ph·ª©c t·∫°p nh·ªè h∆°n <strong>r·∫•t nhi·ªÅu l·∫ßn</strong> so v·ªõi m√¥ h√¨nh SOTA tr∆∞·ªõc ƒë√≥.</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 350px" src='./images/compare_2.png'>
</p>
<h2 id="b√†i-to√°n-model-scaling">B√†i to√°n model scaling</h2>
<p>Gi·∫£ s·ª≠ conv layer th·ª© $i$ ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† h√†m s·ªë $Y_i = F_i(X_i)$, v·ªõi input $X_i$ c√≥ shape l√† $\left (H_i, W_i, C_i \right)$. Khi ƒë√≥, m·ªôt CNN $N$ c√≥ th·ªÉ ƒë∆∞·ª£c bi·ªÉu di·ªÖn l√†</p>
<p>$$
N = F_k \bigodot  F_{k-1} \bigodot  \cdots F_1(X_1) = \bigodot_{j=1,&hellip;,k} F_j(X_1)
$$</p>
<p>Th√¥ng th∆∞·ªùng, c√°c m·∫°ng CNN th∆∞·ªùng ƒë∆∞·ª£c x√¢y d·ª±ng theo ki·ªÉu g·ªìm nhi·ªÅu giai ƒëo·∫°n, m·ªói giai ƒëo·∫°n l√† s·ª± l·∫∑p l·∫°i c√°c block c√≥ c√πng d·∫°ng c·∫•u tr√∫c, ch·ªâ kh√°c nhau m·ªôt s·ªë chi ti·∫øt nh∆∞ s·ªë layer trong block, k√≠ch th∆∞·ªõc c·ªßa filter,‚Ä¶ V√≠ d·ª•, ResNet ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n c√°c residual block, MobileNet th√¨ l√† c√°c depthwise separable block,‚Ä¶ Do ƒë√≥, ta c√≥ th·ªÉ vi·∫øt l·∫°i $N$ th√†nh</p>
<p>$$
N = \bigodot_{i=1,&hellip;,s} F_i ^ {L_i}(X_{(H_i, W_i, C_i})
$$</p>
<p>, v·ªõi $F_i$ l√† layer ƒë∆∞·ª£c l·∫∑p l·∫°i $L_i$ l·∫ßn trong giai ƒëo·∫°n th·ª© $i$, v·ªõi input l√† $X$ c√≥ shape $(H_i, W_i, C_i)$.</p>
<p>B√†i to√°n model scaling s·∫Ω <strong>c·ªë ƒë·ªãnh layer $F_i$</strong> v√† ƒëi ƒëi·ªÅu ch·ªânh c√°c gi√° tr·ªã $L_i, H_i, W_i, C_i$, sao cho m√¥ h√¨nh <strong>th·ªèa m√£n c√°c r√†ng bu·ªôc v·ªÅ t√†i nguy√™n</strong> v√† <strong>ƒë·∫°t ƒë·ªô ch√≠nh x√°c cao nh·∫•t c√≥ th·ªÉ</strong>.</p>
<ul>
<li>ƒêi·ªÅu ch·ªânh $L_i$ $\Leftrightarrow$ ƒêi·ªÅu ch·ªânh depth</li>
<li>ƒêi·ªÅu ch·ªânh $C_i$ $\Leftrightarrow$ ƒêi·ªÅu ch·ªânh width</li>
<li>ƒê·ªÅu ch·ªânh $H_i, W_i$ $\Leftrightarrow$ ƒêi·ªÅu ch·ªânh resolution</li>
</ul>
<p>ƒê·ªÉ gi·∫£m kh√¥ng gian t√¨m ki·∫øm, ta s·∫Ω ƒëi·ªÅu ch·ªânh c√°c gi√° tr·ªã tr√™n c·ªßa to√†n b·ªô layer trong m√¥ h√¨nh theo c√πng m·ªôt t·ªâ l·ªá. Khi ƒë√≥, b√†i to√°n c·ªßa ta l√† b√†i to√°n t·ªëi ∆∞u nh∆∞ sau:</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 180px" src='./images/formula.png'>
</p>
<p>, v·ªõi $d, w, r$ l√† h·ªá s·ªë ƒë·ªÉ ƒëi·ªÅu ch·ªânh depth, width, resolution; $\hat{F_i}, \hat{L_i}, \hat{H_i}, \hat{W_i}, \hat{C_i}$ l√† c√°c gi√° tr·ªã ban ƒë·∫ßu c·ªßa m√¥ h√¨nh baseline.</p>
<h2 id="ph∆∞∆°ng-ph√°p-compound-scaling">Ph∆∞∆°ng ph√°p compound scaling</h2>
<p>Ph∆∞∆°ng ph√°p n√†y s·ª≠ d·ª•ng <strong>compound coefficient $\phi$</strong> ƒë·ªÉ ƒëi·ªÅu ch·ªânh depth, width, resolution theo nguy√™n t·∫Øc nh∆∞ sau:</p>
<ul>
<li>
<p>V·ªõi m√¥ h√¨nh baseline ban ƒë·∫ßu, ta th·ª±c hi·ªán <strong>grid search</strong> ƒë·ªÉ t√¨m ra b·ªô 3 gi√° tr·ªã t·ªâ l·ªá $(d, w, r) = (\alpha, \beta, \gamma)$ t·ªët nh·∫•t c√≥ th·ªÉ, sao cho</p>
<p>$$
\alpha \cdot \beta^2 \cdot \gamma^2 \approx 2 \text{  v√†  } \alpha \geq 1, \beta \geq 1, \gamma \geq 1
$$</p>
</li>
<li>
<p>Sau ƒë√≥, ta s·∫Ω scale m√¥ h√¨nh l√™n theo h·ªá s·ªë $\phi$ v·ªõi</p>
<p>$$
d = \alpha ^ \phi, ; w = \beta^\phi, ; r = \gamma^\phi
$$</p>
</li>
</ul>
<p>V·ªÅ m·∫∑t tr·ª±c gi√°c, ta c√≥ th·ªÉ xem $\phi$ nh∆∞ l√† c√°ch m√† ch√∫ng ta cho bi·∫øt l∆∞·ª£ng t√†i nguy√™n d√†nh cho model scaling l√† bao nhi√™u, c√≤n c√°c gi√° tr·ªã $\alpha, \beta, \gamma$ l√† c√°ch ch√∫ng ta ph√¢n ph·ªëi t√†i nguy√™n ƒë√≥ cho depth, width v√† resolution. Gi·∫£i th√≠ch cho c√°c r√†ng bu·ªôc cho $\alpha, \beta, \gamma$ ƒë∆∞·ª£c tr√¨nh b√†y nh∆∞ sau:</p>
<ul>
<li>T·∫•t nhi√™n l√† ƒë·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c vi·ªác scale m√¥ h√¨nh l√™n th√¨ gi√° tr·ªã c·ªßa ch√∫ng ph·∫£i kh√¥ng nh·ªè h∆°n 1</li>
<li>Ngo√†i ra, m·ªôt ph√©p to√°n convolution s·∫Ω c√≥ ƒë·ªô ph·ª©c t·∫°p t·ªâ l·ªá thu·∫≠n v·ªõi $d, w^2, r^2$. Do ƒë√≥, n·∫øu ta scale model l√™n theo h·ªá s·ªë $\phi$ th√¨ ƒë·ªô ph·ª©c t·∫°p s·∫Ω tƒÉng l√™n m·ªôt l∆∞·ª£ng b·∫±ng $(\alpha \cdot \beta^2 \cdot \gamma^2)^\phi$. C√°c t√°c gi·∫£ mong mu·ªën ƒë·ªô ph·ª©c t·∫°p tƒÉng kho·∫£ng $2^\phi$, do ƒë√≥ ta c√≥ r√†ng bu·ªôc $\alpha \cdot \beta^2 \cdot \gamma^2 \approx 2$.</li>
</ul>
<h2 id="h·ªç-m√¥-h√¨nh-efficientnet">H·ªç m√¥ h√¨nh EfficientNet</h2>
<h3 id="neural-architecture-search">Neural architecture search</h3>
<p>EfficientNet l√† m·ªôt h·ªç c√°c m√¥ h√¨nh r·∫•t ƒë·∫∑c bi·ªát:</p>
<ul>
<li>
<p>Th·ª© nh·∫•t, ch√∫ng ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng ‚Äúm√°y‚Äù üòÄ V√†o nƒÉm 2017, m·ªôt ma thu·∫≠t ƒë√£ ƒë∆∞·ª£c c√¥ng b·ªë trong paper ‚ÄúNeural architecture search with reinforcement learning‚Äù c·ªßa ch√≠nh t√°c gi·∫£ <strong>Quoc V. Le</strong>, n√≥ gi√∫p ch√∫ng ta x√¢y m·ªôt ki·∫øn tr√∫c ph√π h·ª£p nh·∫•t c√≥ th·ªÉ d·ª±a theo ƒë·ªô ch√≠nh x√°c, ƒë·ªô ph·ª©c t·∫°p m√† ch√∫ng ta y√™u c·∫ßu.</p>
<ul>
<li>
<p>V·ªõi h·ªç EfficientNet, c√°c t√°c gi·∫£ t·∫≠p trung v√†o vi·ªác gi·ªõi h·∫°n ƒë·ªô ph·ª©c t·∫°p (c·ª• th·ªÉ l√† FLOPS). M·ª•c ti√™u t·ªëi ∆∞u c·ªßa reinforcement learning l√†</p>
<p>$$
ACC(m) \times \left ( \frac{FLOPS(m)}{T} \right )^w
$$</p>
<p>, v·ªõi $m$ l√† m√¥ h√¨nh, $ACC$ v√† $FLOPS$ l√† ƒë·ªô ch√≠nh x√°c v√† ƒë·ªô ph·ª©c t·∫°p, $T$ l√† FLOPS mong mu·ªën v√† n√≥ b·∫±ng $400 \times 10^6$, $w=-0.07$ l√† h·∫±ng s·ªë ƒëi·ªÅu ch·ªânh trade-off gi·ªØa $ACC$ v√† $FLOPS$</p>
</li>
</ul>
</li>
<li>
<p>Th·ª© hai, t·ª´ m·ªôt m√¥ h√¨nh ban ƒë·∫ßu l√† <strong>EfficientNet-B0</strong>, ta ti·∫øn h√†nh scale theo 2 b∆∞·ªõc:</p>
<ul>
<li>B∆∞·ªõc 1: C·ªë ƒë·ªãnh $\phi = 1$, gi·∫£ s·ª≠ l∆∞·ª£ng t√†i nguy√™n m√† ta c√≥ th·ªÉ s·ª≠ d·ª•ng l√† nhi·ªÅu g·∫•p ƒë√¥i hi·ªán t·∫°i. Khi ƒë√≥, th·ª±c hi·ªán grid search ƒë·ªÉ t√¨m c√°c gi√° tr·ªã $(d, w, r) = (\alpha, \beta, \gamma)$ t·ªët nh·∫•t</li>
<li>B∆∞·ªõc 2: T·ª´ c√°c gi√° tr·ªã $(d, w, r) = (\alpha, \beta, \gamma)$ t√¨m ƒë∆∞·ª£c, ti·∫øn h√†nh scale theo c√°c gi√° tr·ªã $\phi$ l·ªõn h∆°n ƒë·ªÉ c√≥ ƒë∆∞·ª£c c√°c phi√™n b·∫£n B1-B7.</li>
</ul>
</li>
</ul>
<p>·ªû ƒë√¢y, ta ho√†n to√†n c√≥ th·ªÉ tƒÉng $\phi$ l√™n r·ªìi l·∫°i grid search nh∆∞ng l√∫c n√†y chi ph√≠ th·ª±c hi·ªán l√† r·∫•t l·ªõn. Do ƒë√≥, c√°c t√°c gi·∫£ ch·ªâ grid search m·ªôt l·∫ßn r·ªìi sau ƒë√≥ ch·ªâ c·∫ßn tƒÉng $\phi$.</p>
<h3 id="ki·∫øn-tr√∫c-m√¥-h√¨nh">Ki·∫øn tr√∫c m√¥ h√¨nh</h3>
<p>ƒê·∫ßu ti√™n, t·ªïng quan ki·∫øn tr√∫c c·ªßa EfficientNet-B0 nh∆∞ sau:</p>
<p style="display: flex; flex-direction: column; align-items: center;">
<img style="max-height: 250px" src='./images/efficientnet.png'>
</p>
<ul>
<li>Trong ƒë√≥:
<ul>
<li><strong>MBConv</strong> ch√≠nh l√† inverted residual block trong MobileNetV2, c√πng v·ªõi m·ªôt s·ªë c·∫£i ti·∫øn nh∆∞ trong paper ‚ÄúSqueeze-and-excitation networks‚Äù</li>
</ul>
</li>
</ul>
<p>C√°c m√¥ h√¨nh EfficientNet-B1 cho ƒë·∫øn B7 ch√≠nh l√† k·∫øt qu·∫£ c·ªßa vi·ªác √°p d·ª•ng compound scaling l√™n EfficientNet-B0.</p>
<h2 id="t√†i-li·ªáu-tham-kh·∫£o">T√†i li·ªáu tham kh·∫£o</h2>
<ul>
<li>Paper EfficientNet: <a class="link" href="https://arxiv.org/abs/1905.11946"  target="_blank" rel="noopener"
    >https://arxiv.org/abs/1905.11946</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/cnn/">cnn</a>
        
            <a href="/tags/efficientnet/">efficientnet</a>
        
            <a href="/tags/compound-scaling/">compound scaling</a>
        
            <a href="/tags/grid-search/">grid search</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/mobilenet_v2/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet V2 (2019)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/densenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">DenseNet (2018)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/cam/">
        
        

        <div class="article-details">
            <h2 class="article-title">CAM, Grad-CAM v√† Score-CAM trong CNN</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/mobilenet/">
        
        

        <div class="article-details">
            <h2 class="article-title">MobileNet (2017)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/inception-resnet/">
        
        

        <div class="article-details">
            <h2 class="article-title">Inception-Reset (2016)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

<div id="disqus_thread"></div>

<p><b>L∆∞u √Ω.</b> N·∫øu ph·∫ßn Comment kh√¥ng load ra ƒë∆∞·ª£c th√¨ c√°c b·∫°n v√†o DNS setting c·ªßa Wifi/LAN v√† ƒë·ªïi th√†nh "8.8.8.8" nh√© (server c·ªßa Google)!</p>


<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://htrvu-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 Hoang Trong Vu
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
